(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const c of i.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function n(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(o){if(o.ep)return;o.ep=!0;const i=n(o);fetch(o.href,i)}})();const qt={rock:"✊",paper:"✋",scissors:"✌️",fire:"🔥"};function pt(e,t){return e===t?"draw":e==="rock"&&t==="scissors"||e==="paper"&&t==="rock"||e==="scissors"&&t==="paper"?"win":e==="fire"?t==="scissors"||t==="paper"?"win":"lose":t==="fire"?e==="scissors"||e==="paper"?"lose":"win":"lose"}function q(e){return qt[e]||"❓"}function ht(e,t,n){const s=q(t),o=q(n);return e==="win"?t==="fire"&&(n==="scissors"||n==="paper")?`${s} Fire burns ${o}! You win!`:t==="rock"&&n==="fire"?`${s} Rock smothers ${o}! You win!`:`${s} beats ${o}! You win!`:e==="lose"?n==="fire"&&(t==="scissors"||t==="paper")?`${o} Fire burns ${s}! You lose!`:n==="rock"&&t==="fire"?`${o} Rock smothers ${s}! You lose!`:`${o} beats ${s}! You lose!`:`${s} ties with ${o}! It's a draw!`}const u={landingPage:document.getElementById("landing-page"),gameScreen:document.getElementById("game-screen"),resultsScreen:document.getElementById("results-screen"),endlessModeBtn:document.getElementById("endless-mode-btn"),bestOf5Btn:document.getElementById("best-of-5-btn"),backToMenuBtn:document.getElementById("back-to-menu"),backToMenuResultBtn:document.getElementById("back-to-menu-btn"),playAgainBtn:document.getElementById("play-again-btn"),moveButtons:document.querySelectorAll(".move-btn"),themeToggleBtn:document.getElementById("theme-toggle-btn"),resetScoresBtn:document.getElementById("reset-scores"),soundToggleBtn:document.getElementById("sound-toggle"),playerScore:document.getElementById("player-score"),aiScore:document.getElementById("ai-score"),playerMoveDisplay:document.getElementById("player-move-display"),aiMoveDisplay:document.getElementById("ai-move-display"),resultTitle:document.getElementById("result-title"),resultMessage:document.getElementById("result-message"),playerMoveResult:document.getElementById("player-move"),aiMoveResult:document.getElementById("ai-move")};function C(e){u.landingPage.classList.add("hidden"),u.gameScreen.classList.add("hidden"),u.resultsScreen.classList.add("hidden");const t=document.getElementById(e);t?t.classList.remove("hidden"):console.error("Invalid section ID:",e)}function te(e,t){u.playerScore.textContent=e,u.aiScore.textContent=t}function Se(e,t){u.playerMoveDisplay.textContent=q(e),u.aiMoveDisplay.textContent=q(t)}function vt(e,t,n,s){let o,i;switch(e){case"win":o="You Win!",i="win";break;case"lose":o="You Lose!",i="lose";break;case"draw":o="It's a Draw!",i="draw";break;default:o="Game Result",i=""}u.resultTitle.textContent=o,u.resultMessage.textContent=t,u.resultMessage.className=`result-message ${i}`,u.playerMoveResult.textContent=q(n),u.aiMoveResult.textContent=q(s),C("results-screen")}function jt(e){e.startEndlessMode&&u.endlessModeBtn&&u.endlessModeBtn.addEventListener("click",e.startEndlessMode),e.backToMenu&&(u.backToMenuBtn&&u.backToMenuBtn.addEventListener("click",e.backToMenu),u.backToMenuResultBtn&&u.backToMenuResultBtn.addEventListener("click",e.backToMenu)),e.playAgain&&u.playAgainBtn&&u.playAgainBtn.addEventListener("click",e.playAgain),e.makeMove&&u.moveButtons&&u.moveButtons.forEach(t=>{t.addEventListener("click",()=>{const n=t.getAttribute("data-move");e.makeMove(n)})}),e.toggleTheme&&u.themeToggleBtn&&u.themeToggleBtn.addEventListener("click",e.toggleTheme),e.resetScores&&u.resetScoresBtn&&u.resetScoresBtn.addEventListener("click",e.resetScores)}const qe="rock-paper-battle",Oe={theme:"day",soundEnabled:!0,soundVolume:.5,stats:{wins:0,losses:0,draws:0,longestWinStreak:0,bestMode:""},achievements:{winStreak3:!1,flawlessVictory:!1,roundsPlayed10:!1},profile:{name:"Player",avatar:"👤"},unlocks:{secretMoveUnlocked:!1,secretMoveRevealed:!1},currentWinStreak:0};let P=null;function d(e=null){if(!P)try{const t=localStorage.getItem(qe);P=t?JSON.parse(t):{...Oe}}catch(t){console.error("Error loading data from localStorage:",t),P={...Oe}}return e?P[e]:P}function r(e,t){const n=d();n[e]=t;try{localStorage.setItem(qe,JSON.stringify(n)),P=n}catch(s){console.error("Error saving data to localStorage:",s)}}function ce(e){if(!["wins","losses","draws"].includes(e)){console.error(`Invalid stat name: ${e}`);return}const t=d("stats")||{};t[e]=(t[e]||0)+1,r("stats",t)}function yt(){try{localStorage.removeItem(qe),P={...Oe}}catch(e){console.error("Error clearing data from localStorage:",e)}}const L={audio:["click.wav","win.wav","lose.wav","draw.wav","gameStart.wav","gameWin.wav","gameLose.wav","gameDraw.wav","countdown.wav","tick.wav","timeUp.wav","bonusRound.wav","chaos.wav"],ambientAudio:["wind.wav","hum.wav","lo-fi-loop.wav"],images:["logo.webp"],icons:["favicon-96x96.png","apple-touch-icon.png","favicon.svg","web-app-manifest-192x192.png","web-app-manifest-512x512.png"]},K={audio:{},images:{},icons:{}};let De=0,re=0,xe=!1,de=null,le=null;function Yt(){return d("audioStyle")||"retro"}function Gt(e=null,t=null){xe||(xe=!0,de=e,le=t,De=L.audio.length+L.ambientAudio.length+L.images.length+L.icons.length,re=0,L.audio.forEach(n=>{ve(n)}),L.ambientAudio.forEach(n=>{ve(n,!0)}),L.images.forEach(n=>{Kt(n)}),L.icons.forEach(n=>{Jt(n)}))}function ve(e,t=!1){const n=Yt(),s=t?`./audio/${n}/ambient/${e}`:`./audio/${n}/${e}`,o=new Audio(s);o.addEventListener("canplaythrough",()=>{j()},{once:!0}),o.addEventListener("error",()=>{console.warn(`Failed to load audio file: ${e}`),j()},{once:!0}),o.load();const i=t?`ambient_${e.split(".")[0]}`:e.split(".")[0];K.audio[i]=o}function Kt(e){const t=new Image;t.onload=()=>{j()},t.onerror=()=>{console.warn(`Failed to load image file: ${e}`),j()},t.src=`./images/${e}`;const n=e.split(".")[0];K.images[n]=t}function Jt(e){const t=new Image;t.onload=()=>{j()},t.onerror=()=>{console.warn(`Failed to load icon file: ${e}`),j()},t.src=`./icons/${e}`;const n=e.split(".")[0];K.icons[n]=t}function j(e){re++;const t=Math.floor(re/De*100);de&&typeof de=="function"&&de(t),re>=De&&(xe=!1,le&&typeof le=="function"&&le())}function Et(e,t=!1){const n=t?`ambient_${e}`:e;return!!K.audio[n]}function wt(e,t=!1){const n=t?`ambient_${e}`:e;return K.audio[n]||null}function Pe(){K.audio={},L.audio.forEach(e=>{ve(e)}),L.ambientAudio.forEach(e=>{ve(e,!0)})}const zt={click:"click.wav",win:"win.wav",lose:"lose.wav",draw:"draw.wav",gameStart:"gameStart.wav",gameWin:"gameWin.wav",gameLose:"gameLose.wav",gameDraw:"gameDraw.wav",countdown:"countdown.wav",tick:"tick.wav",timeUp:"timeUp.wav",bonusRound:"bonusRound.wav",chaos:"chaos.wav"},Qt={wind:"wind.wav",hum:"hum.wav",lofi:"lo-fi-loop.wav"};let M=!0,Ie=!0,ne=.5,W=.3,w=null,Y="retro";function Zt(){M=d("soundEnabled")!==!1,Ie=d("ambientEnabled")!==!1,Y=d("audioStyle")||"retro";const e=d("soundVolume");e!==void 0&&(ne=e);const t=d("ambientVolume");t!==void 0&&(W=t),je()}function je(){const e=document.getElementById("sound-toggle");e&&(e.textContent=M?"🔊":"🔇",e.title=M?"Sound On (Click to Mute)":"Sound Off (Click to Unmute)")}function a(e){if(!M)return;const t=zt[e];if(!t)return;let n;Et(e)&&(n=wt(e),n&&(n=n.cloneNode())),n||(n=new Audio(`./audio/${Y}/${t}`)),n.volume=ne,n.play().catch(s=>console.warn("Error playing sound:",s))}function Xt(e="lofi"){if(!Ie)return;Be();const t=Qt[e];t&&(Et(e,!0)?w=wt(e,!0):w=new Audio(`./audio/${Y}/ambient/${t}`),w&&(w.volume=W,w.loop=!0,w.play().catch(n=>console.warn("Error playing ambient sound:",n))))}function Be(){w&&(w.pause(),w.currentTime=0,w=null)}function en(){M=!M,r("soundEnabled",M),je(),M&&a("click")}function at(e){M=e,r("soundEnabled",e),je()}function tn(){return M}function nn(e){Ie=e,r("ambientEnabled",e),e||Be()}function sn(){return Ie}function on(e){ne=Math.max(0,Math.min(1,e)),r("soundVolume",ne)}function an(){return ne}function cn(e){W=Math.max(0,Math.min(1,e)),r("ambientVolume",W),w&&(w.volume=W)}function rn(){return W}function ct(e){e!=="modern"&&e!=="retro"||(Y=e,r("audioStyle",Y),Pe())}function dn(){return Y}const Ne={winStreak3:{id:"winStreak3",name:"3 Wins in a Row",description:"Win 3 games in a row",icon:"🥉"},flawlessVictory:{id:"flawlessVictory",name:"Flawless Victory",description:"Win all rounds in a Best of 5 match",icon:"🥇"},roundsPlayed10:{id:"roundsPlayed10",name:"10 Total Rounds Played",description:"Play 10 or more rounds",icon:"📊"}};let _=0;function ln(){d("achievements")||r("achievements",{winStreak3:!1,flawlessVictory:!1,roundsPlayed10:!1}),_=d("currentWinStreak")||0}function Ye(e,t={},n="endless"){e==="win"?_++:e==="lose"&&(_=0),r("currentWinStreak",_),_>=3&&Ce("winStreak3"),n==="bestOf5"&&t.gameOver&&t.playerScore>=3&&t.aiScore===0&&Ce("flawlessVictory");const s=d("stats");(s.wins||0)+(s.losses||0)+(s.draws||0)>=10&&Ce("roundsPlayed10")}function Ce(e){if(!Ne[e]){console.error(`Achievement "${e}" does not exist`);return}const t=d("achievements");t[e]||(t[e]=!0,r("achievements",t),a("win"),un(Ne[e]))}function un(e){const t=document.createElement("div");t.className="achievement-notification",t.innerHTML=`
        <div class="achievement-icon">${e.icon}</div>
        <div class="achievement-content">
            <h3>Achievement Unlocked!</h3>
            <p class="achievement-name">${e.name}</p>
            <p class="achievement-description">${e.description}</p>
        </div>
    `,document.body.appendChild(t),setTimeout(()=>{t.classList.add("show")},100),setTimeout(()=>{t.classList.remove("show"),setTimeout(()=>{document.body.removeChild(t)},500)},5e3)}function mn(){const e=d("achievements")||{};return Object.values(Ne).map(t=>({...t,unlocked:e[t.id]||!1}))}function Fe(){r("achievements",{winStreak3:!1,flawlessVictory:!1,roundsPlayed10:!1}),_=0,r("currentWinStreak",0)}function fn(){d("stats")||r("stats",{wins:0,losses:0,draws:0,longestWinStreak:0,bestMode:""})}function bt(e){const t=d("stats");e>t.longestWinStreak&&(t.longestWinStreak=e,r("stats",t))}function Ue(e){const t=d("stats");t.bestMode=e,r("stats",t)}function kt(){const e=d("stats")||{wins:0,losses:0,draws:0,longestWinStreak:0,bestMode:"None"},t=document.getElementById("stats-wins"),n=document.getElementById("stats-losses"),s=document.getElementById("stats-draws"),o=document.getElementById("stats-streak"),i=document.getElementById("stats-best-mode"),c=document.getElementById("stats-win-rate"),m=document.getElementById("stats-total-games");t&&(t.textContent=e.wins),n&&(n.textContent=e.losses),s&&(s.textContent=e.draws),o&&(o.textContent=e.longestWinStreak),i&&(i.textContent=e.bestMode||"None");const v=e.wins+e.losses+e.draws,p=v>0?Math.round(e.wins/v*100):0;c&&(c.textContent=`${p}%`),m&&(m.textContent=v),gn(e,v)}function gn(e,t){const n=document.getElementById("stats-wins-bar"),s=document.getElementById("stats-losses-bar"),o=document.getElementById("stats-draws-bar");if(!n||!s||!o)return;const i=t>0?Math.max(2,e.wins/t*100):2,c=t>0?Math.max(2,e.losses/t*100):2,m=t>0?Math.max(2,e.draws/t*100):2;n.style.width=`${i}%`,s.style.width=`${c}%`,o.style.width=`${m}%`}function _e(){r("stats",{wins:0,losses:0,draws:0,longestWinStreak:0,bestMode:""}),kt(),a("click")}function pn(){document.getElementById("landing-page").classList.add("hidden"),document.getElementById("game-screen").classList.add("hidden"),document.getElementById("results-screen").classList.add("hidden"),document.getElementById("stats-screen").classList.remove("hidden"),kt(),a("click")}function hn(){document.getElementById("stats-screen").classList.add("hidden"),document.getElementById("landing-page").classList.remove("hidden"),a("click")}const vn=10;let J=!1;function Ge(){J=(d("unlocks")||{}).secretMoveUnlocked||!1,yn(),Ke()}function yn(){if(J)return;((d("stats")||{}).wins||0)>=vn&&En()}function En(){J=!0;const e=d("unlocks")||{};e.secretMoveUnlocked=!0,r("unlocks",e),Ke(),setTimeout(wn,1e3)}function Ke(){const e=document.getElementById("fire-move-btn");if(e)if(J){e.classList.remove("hidden");const t=d("unlocks")||{};t.secretMoveUnlocked&&!t.secretMoveRevealed&&(e.classList.add("fire-reveal"),t.secretMoveRevealed=!0,r("unlocks",t),setTimeout(()=>{e.classList.add("fire-glow"),setTimeout(()=>{e.classList.remove("fire-glow")},5e3)},1e3))}else e.classList.add("hidden")}function wn(){const e=document.createElement("div");e.className="achievement-notification",e.innerHTML=`
        <div class="achievement-icon">🔥</div>
        <div class="achievement-content">
            <h3>New Move Unlocked!</h3>
            <p class="achievement-name">Fire Move</p>
            <p class="achievement-description">You've unlocked the secret Fire move!</p>
        </div>
    `,document.body.appendChild(e),a("win"),setTimeout(()=>{e.classList.add("show")},100),setTimeout(()=>{e.classList.remove("show"),setTimeout(()=>{document.body.removeChild(e)},500)},5e3)}function se(){return J}function We(){J=!1;const e=d("unlocks")||{};e.secretMoveUnlocked=!1,e.secretMoveRevealed=!1,r("unlocks",e),Ke()}const E={RANDOM:"random",CHEEKY:"cheeky",PREDICTIVE:"predictive"};let z=E.RANDOM;const O={rock:0,paper:0,scissors:0,fire:0};let X=null;function bn(){const e=d("aiMode");e&&Object.values(E).includes(e)?z=e:r("aiMode",E.RANDOM),Le()}function Le(){O.rock=0,O.paper=0,O.scissors=0,O.fire=0,X=null}function St(e){O[e]!==void 0&&(O[e]++,X=e)}function It(e){switch(z){case E.CHEEKY:return kn(e);case E.PREDICTIVE:return Sn(e);case E.RANDOM:default:return oe(e)}}function oe(e){const t=Math.floor(Math.random()*e.length);return e[t]}function kn(e){return X&&e.includes(X)&&Math.random()<.4?X:oe(e)}function Sn(e){let t="rock",n=0;for(const[i,c]of Object.entries(O))c>n&&(n=c,t=i);if(Object.values(O).reduce((i,c)=>i+c,0)<3)return oe(e);let o;switch(t){case"rock":o="paper";break;case"paper":o="scissors";break;case"scissors":o="rock";break;case"fire":o="rock";break;default:o="rock"}return e.includes(o)?o:oe(e)}function In(e){Object.values(E).includes(e)?(z=e,r("aiMode",e),Le()):console.error(`Invalid AI mode: ${e}`)}function G(){return z}function Bt(){switch(z){case E.CHEEKY:return"Cheeky";case E.PREDICTIVE:return"Predictive";case E.RANDOM:default:return"Random"}}function Lt(){switch(z){case E.CHEEKY:return"😏";case E.PREDICTIVE:return"🧠";case E.RANDOM:default:return"🤖"}}const Mt=3e3,At=50,Bn=1e3;let ie=!1,ue=null,me=null,F=0,fe=null,b=null,ye=!1;function Ln(){const e=d("speedMode");e!==void 0?ie=e:(r("speedMode",!1),ie=!1),Mn()}function Mn(){if(document.getElementById("speed-timer")){b=document.getElementById("speed-timer");return}const e=document.createElement("div");e.id="speed-timer-container",e.className="speed-timer-container hidden",b=document.createElement("div"),b.id="speed-timer",b.className="speed-timer",e.appendChild(b);const t=document.getElementById("game-screen");if(t){const n=t.querySelector(".game-header");n?n.insertAdjacentElement("afterend",e):t.insertAdjacentElement("afterbegin",e)}else document.body.appendChild(e)}function Q(){return ie}function An(e){ie=e,r("speedMode",e)}function Rn(e=Mt,t=null){if(!ie||ye)return!1;fe=t,F=e,ye=!0;const n=document.getElementById("speed-timer-container");return n&&n.classList.remove("hidden"),b&&(b.style.width="100%",b.classList.remove("warning")),N(),ue=setTimeout(()=>{Tn()},e),me=setInterval(()=>{Cn()},At),a("countdown"),!0}function N(){ue&&(clearTimeout(ue),ue=null),me&&(clearInterval(me),me=null),ye=!1;const e=document.getElementById("speed-timer-container");e&&e.classList.add("hidden")}function Tn(){a("timeUp"),fe&&typeof fe=="function"&&fe(),N()}function Cn(){if(!b||!ye)return;F-=At,F<0&&(F=0);const e=F/Mt*100;b.style.width=`${e}%`,F<=Bn&&!b.classList.contains("warning")&&(b.classList.add("warning"),a("tick"))}function $n(e){return oe(e)}const On=.2,T={DOUBLE_POINTS:"double-points",REVERSE_RULES:"reverse-rules",CHAOS_MODE:"chaos-mode"};let Me=!0,R=null,ee={};function Dn(){const e=d("bonusEnabled");e!==void 0?Me=e:r("bonusEnabled",!0)}function Rt(){return Me}function xn(e){Me=e,r("bonusEnabled",e)}function Pn(){return Me?Math.random()<On:!1}function Nn(){R&&V();const e=Object.values(T),t=Math.floor(Math.random()*e.length),n=e[t];return Fn(n),n}function Fn(e){if(!Object.values(T).includes(e)){console.error(`Invalid bonus type: ${e}`);return}R=e,Un(e),Vn(e),a("bonusRound")}function Un(e){const t=document.querySelector(".game-area");switch(t&&(t.classList.add("bonus-round"),t.classList.add(e)),e){case T.CHAOS_MODE:_n();break}}function _n(){const e=document.querySelectorAll(".move-btn:not(.hidden)");if(e.length<2)return;ee={},e.forEach(n=>{const s=n.getAttribute("data-move");ee[s]=n.textContent}),Array.from(e).map(n=>n.getAttribute("data-move"));const t=Array.from(e).map(n=>n.textContent);for(let n=t.length-1;n>0;n--){const s=Math.floor(Math.random()*(n+1));[t[n],t[s]]=[t[s],t[n]]}e.forEach((n,s)=>{n.textContent=t[s],n.classList.add("chaos-mode-btn")}),a("chaos")}function V(){if(!R)return;const e=document.querySelector(".game-area");switch(e&&(e.classList.remove("bonus-round"),e.classList.remove(R)),R){case T.CHAOS_MODE:Wn();break}R=null}function Wn(){document.querySelectorAll(".move-btn").forEach(t=>{const n=t.getAttribute("data-move");ee[n]&&(t.textContent=ee[n]),t.classList.remove("chaos-mode-btn")}),ee={}}function Vn(e){let t,n,s;switch(e){case T.DOUBLE_POINTS:t="Double Points Round!",n="Win this round to earn double points!",s="🎯";break;case T.REVERSE_RULES:t="Reverse Rules!",n="The rules are reversed! Rock beats Paper, Paper beats Scissors, Scissors beats Rock!",s="🔁";break;case T.CHAOS_MODE:t="Chaos Mode!",n="Move labels are scrambled! Choose wisely!",s="🎲";break;default:t="Bonus Round!",n="Special rules apply this round!",s="🎁"}const o=document.createElement("div");o.className="bonus-notification",o.innerHTML=`
        <div class="bonus-notification-icon">${s}</div>
        <div class="bonus-notification-content">
            <h3>${t}</h3>
            <p>${n}</p>
        </div>
    `,document.body.appendChild(o),setTimeout(()=>{o.classList.add("show")},100),setTimeout(()=>{o.classList.remove("show"),setTimeout(()=>{document.body.removeChild(o)},500)},4e3)}function Hn(e,t,n){if(!R)return e;switch(R){case T.REVERSE_RULES:return qn(e,t,n);default:return e}}function qn(e,t,n){if(t===n)return"draw";if(t==="rock"&&n==="paper"||t==="paper"&&n==="scissors"||t==="scissors"&&n==="rock")return"win";if(t==="paper"&&n==="rock"||t==="scissors"&&n==="paper"||t==="rock"&&n==="scissors")return"lose";if(t==="fire"){if(n==="scissors"||n==="paper")return"win";if(n==="rock")return"lose"}if(n==="fire"){if(t==="scissors"||t==="paper")return"lose";if(t==="rock")return"win"}return e}function jn(){return R===T.DOUBLE_POINTS?2:1}const f={playerScore:0,aiScore:0,currentRound:0,lastPlayerMove:null,lastAiMove:null,lastResult:null,bonusRoundActive:!1,bonusType:null,timeoutMove:null};function Yn(){Tt(),document.querySelector("#game-screen h2").textContent="Endless Mode",Gn();const e=d("stats");e?te(e.wins,e.losses):te(0,0),C("game-screen"),a("gameStart"),Q()&&Je()}function Je(){Q()&&Rn(3e3,()=>{const t=se()?["rock","paper","scissors","fire"]:["rock","paper","scissors"],n=$n(t);f.timeoutMove=n,Ee(n,!0)})}function Gn(){const e=document.getElementById("ai-mode-indicator");if(e){e.className="ai-mode-indicator",e.textContent=Lt();const t=G();t==="random"?e.classList.add("ai-random-indicator"):t==="cheeky"?e.classList.add("ai-cheeky-indicator"):t==="predictive"&&e.classList.add("ai-predictive-indicator"),e.title=`${Bt()} AI Mode`}}function Tt(){f.currentRound=0,f.lastPlayerMove=null,f.lastAiMove=null,f.lastResult=null,f.bonusRoundActive=!1,f.bonusType=null,f.timeoutMove=null,Se("",""),Le(),V()}function Ee(e,t=!1){St(e),!f.bonusRoundActive&&Rt()&&Pn()&&(f.bonusRoundActive=!0,f.bonusType=Nn());const s=se()?["rock","paper","scissors","fire"]:["rock","paper","scissors"],o=It(s);let i=pt(e,o);f.bonusRoundActive&&(i=Hn(i,e,o)),f.lastPlayerMove=e,f.lastAiMove=o,f.lastResult=i,f.currentRound++,Se(e,o),Jn(i,t),a(i==="win"?"win":i==="lose"?"lose":"draw"),Ye(i,f,"endless"),se()||Ge();const c=ht(i,e,o);Kn(i),setTimeout(()=>{vt(i,c,e,o),f.bonusRoundActive&&(V(),f.bonusRoundActive=!1,f.bonusType=null)},1e3)}function Kn(e){const t=document.getElementById("player-move-display"),n=document.getElementById("ai-move-display");switch(e){case"win":window.showWinAnimation&&window.showWinAnimation();break;case"lose":window.showLossAnimation&&t&&window.showLossAnimation(t);break;case"draw":window.showDrawAnimation&&t&&n&&(window.showDrawAnimation(t),window.showDrawAnimation(n));break}}function Jn(e,t){const n=f.bonusRoundActive?jn():1;if(t&&e!=="win"&&(e="lose"),e==="win")for(let o=0;o<n;o++)ce("wins");else ce(e==="lose"?"losses":"draws");f.bonusRoundActive&&e==="win"&&zn();const s=d("stats");if(te(s.wins,s.losses),e==="win"){const o=d("currentWinStreak")||0;bt(o)}Qn(e)}function zn(){const e=d("bonusRoundsWon")||0;r("bonusRoundsWon",e+1);const t=document.getElementById("stats-bonus-rounds");t&&(t.textContent=e+1)}function Qn(e){if(e!=="win")return;const t=G(),n=d("aiStats")||{random:{wins:0},cheeky:{wins:0},predictive:{wins:0}};n[t]||(n[t]={wins:0}),n[t].wins=(n[t].wins||0)+1,r("aiStats",n);const s=document.getElementById("stats-best-ai-mode");if(s){let o="random",i=0;for(const[v,p]of Object.entries(n))p.wins>i&&(i=p.wins,o=v);let c="Random",m="🤖";switch(o){case"cheeky":c="Cheeky",m="😏";break;case"predictive":c="Predictive",m="🧠";break;default:c="Random",m="🤖";break}s.textContent=`${m} ${c}`}}function Zn(){a("click"),C("landing-page"),N()}function Xn(){a("click"),C("game-screen"),Q()&&Je()}function es(){const e=d();e.stats.wins=0,e.stats.losses=0,e.stats.draws=0,r("stats",e.stats),te(0,0),Tt(),r("currentWinStreak",0),a("click"),Q()&&Je()}const l={playerScore:0,aiScore:0,currentRound:0,maxRounds:5,lastPlayerMove:null,lastAiMove:null,lastResult:null,gameOver:!1};function ts(){ze(),document.querySelector("#game-screen h2").textContent="Best of 5",ns(),C("game-screen"),a("gameStart")}function ns(){const e=document.getElementById("ai-mode-indicator");if(e){e.className="ai-mode-indicator",e.textContent=Lt();const t=G();t==="random"?e.classList.add("ai-random-indicator"):t==="cheeky"?e.classList.add("ai-cheeky-indicator"):t==="predictive"&&e.classList.add("ai-predictive-indicator"),e.title=`${Bt()} AI Mode`}}function ze(){l.playerScore=0,l.aiScore=0,l.currentRound=0,l.lastPlayerMove=null,l.lastAiMove=null,l.lastResult=null,l.gameOver=!1,Se("",""),Ct(),Le()}function Ct(){te(l.playerScore,l.aiScore)}function Ve(e){if(l.gameOver)return;St(e);const n=se()?["rock","paper","scissors","fire"]:["rock","paper","scissors"],s=It(n),o=pt(e,s);l.lastPlayerMove=e,l.lastAiMove=s,l.lastResult=o,l.currentRound++,o==="win"?(l.playerScore++,a("win")):o==="lose"?(l.aiScore++,a("lose")):a("draw"),Ct(),Se(e,s);const i=ht(o,e,s),c=os();if(Ye(o,l,"bestOf5"),se()||Ge(),setTimeout(()=>{c?is():vt(o,i,e,s)},1e3),ce(o==="win"?"wins":o==="lose"?"losses":"draws"),o==="win"){const m=d("currentWinStreak")||0;bt(m),ss(o)}}function ss(e){if(e!=="win")return;const t=G(),n=d("aiStats")||{random:{wins:0},cheeky:{wins:0},predictive:{wins:0}};n[t]||(n[t]={wins:0}),n[t].wins=(n[t].wins||0)+1,r("aiStats",n);const s=document.getElementById("stats-best-ai-mode");if(s){let o="random",i=0;for(const[v,p]of Object.entries(n))p.wins>i&&(i=p.wins,o=v);let c="Random",m="🤖";switch(o){case"cheeky":c="Cheeky",m="😏";break;case"predictive":c="Predictive",m="🧠";break;default:c="Random",m="🤖";break}s.textContent=`${m} ${c}`}}function os(){return l.playerScore>=3||l.aiScore>=3||l.currentRound>=l.maxRounds?(l.gameOver=!0,!0):!1}function is(){const e=l.playerScore>l.aiScore,t=l.playerScore===l.aiScore;let n,s,o;t?(n="It's a Draw!",s=`Final Score: ${l.playerScore}-${l.aiScore}`,o="draw",a("gameDraw")):e?(n="You Win the Match!",s=`Final Score: ${l.playerScore}-${l.aiScore}`,o="win",a("gameWin"),Ue("Best of 5"),l.aiScore===0&&Ye("win",l,"bestOf5")):(n="You Lose the Match!",s=`Final Score: ${l.playerScore}-${l.aiScore}`,o="lose",a("gameLose"));const i=document.getElementById("result-title"),c=document.getElementById("result-message");i.textContent=n,c.textContent=s,c.className=`result-message ${o}`,C("results-screen")}function as(){a("click"),C("landing-page")}function cs(){a("click"),l.gameOver&&ze(),C("game-screen")}function rs(){ze(),a("click")}const Ae=["day","night","retro","neon"];let we="day";function ds(){const e=d("theme");e&&Ae.includes(e)&&(we=e),$t(we)}function ls(){document.querySelectorAll(".theme-option").forEach(t=>{t.addEventListener("click",()=>{const n=t.getAttribute("data-theme");n&&Ae.includes(n)&&(Qe(n),rt(n),a("click"))})}),rt(we)}function rt(e){document.querySelectorAll(".theme-option").forEach(s=>{s.classList.remove("active")});const n=document.querySelector(`.theme-option[data-theme="${e}"]`);n&&n.classList.add("active")}function Qe(e){if(!Ae.includes(e)){console.error(`Theme "${e}" is not valid`);return}we=e,r("theme",e),$t(e)}function $t(e){document.body.classList.remove(...Ae.map(t=>`theme-${t}`)),document.body.classList.add(`theme-${e}`)}const Ze={name:"Player",avatar:"👤"};let k={...Ze};function us(){const e=d("profile");e?k=e:r("profile",Ze),Xe()}function ms(){document.querySelectorAll(".avatar-option").forEach(s=>{s.addEventListener("click",()=>{const o=s.getAttribute("data-avatar");o&&(Ot(o),dt(o),a("click"))})});const t=document.getElementById("player-name-input");t&&(t.value=k.name);const n=document.getElementById("save-profile-btn");n&&n.addEventListener("click",fs),dt(k.avatar)}function dt(e){document.querySelectorAll(".avatar-option").forEach(s=>{s.classList.remove("selected")});const n=document.querySelector(`.avatar-option[data-avatar="${e}"]`);n&&(n.classList.add("selected"),n.classList.add("avatar-highlight"),setTimeout(()=>{n.classList.remove("avatar-highlight")},500))}function Ot(e){k.avatar=e}function fs(){const e=document.getElementById("player-name-input");e&&e.value.trim()&&(k.name=e.value.trim()),r("profile",k),Xe(),a("win"),gs()}function gs(){const e=document.getElementById("save-profile-btn");if(e){const t=e.textContent;e.textContent="Saved!",e.disabled=!0,setTimeout(()=>{e.textContent=t,e.disabled=!1},1500)}}function Xe(){const e=document.getElementById("player-avatar"),t=document.getElementById("player-name");e&&(e.textContent=k.avatar),t&&(t.textContent=k.name);const n=document.getElementById("game-player-avatar"),s=document.getElementById("game-player-name");n&&(n.textContent=k.avatar),s&&(s.textContent=k.name)}function ps(){k={...Ze},r("profile",k),Xe()}const hs=7e3,vs=1e3;let $e=null,Re=!1,Dt=Date.now(),H=[];const ys=[".move-btn",".player-choice",".ai-choice"];function Es(){ws(),bs()}function ws(){document.addEventListener("mousemove",S),document.addEventListener("click",S),document.addEventListener("keydown",S),document.addEventListener("touchstart",S),document.addEventListener("touchmove",S)}function bs(){$e&&clearInterval($e),$e=setInterval(ks,vs)}function S(){Dt=Date.now(),Re&&Is()}function ks(){Date.now()-Dt>=hs&&!Re&&Ss()}function Ss(){Re=!0,Bs(),Ls(),d("ambientEnabled")!==!1&&Xt()}function Is(){Re=!1,Ms(),Be()}function Bs(){H=[],ys.forEach(t=>{document.querySelectorAll(t).forEach(s=>{s.offsetParent!==null&&H.push(s)})});const e=document.querySelector("section:not(.hidden)");e&&H.push(e)}function Ls(){H.forEach((e,t)=>{e.classList.contains("idle-animation")||(e.classList.contains("move-btn")?(e.classList.add("idle-animation","idle-pulse"),e.style.animationDelay=`${t*.2}s`):e.classList.contains("player-choice")||e.classList.contains("ai-choice")?e.classList.add("idle-animation","idle-glow"):e.tagName.toLowerCase()==="section"&&e.classList.add("idle-animation","idle-background"))}),document.body.classList.add("idle")}function Ms(){H.forEach(t=>{t.classList.remove("idle-animation","idle-pulse","idle-glow","idle-background"),t.style.animationDelay=""}),document.querySelectorAll(".idle-animation").forEach(t=>{t.classList.remove("idle-animation","idle-pulse","idle-glow","idle-background"),t.style.animationDelay=""}),document.body.classList.remove("idle"),H=[]}const lt="high-contrast",ut="reduced-motion";let I=!1,B=!1;function As(){Rs(),Ts(),Cs(),ae()}function Rs(){window.matchMedia("(prefers-reduced-motion: reduce)").matches&&(B=!0,r("reducedMotion",!0)),window.matchMedia("(prefers-contrast: more)").matches&&(I=!0,r("highContrast",!0))}function Ts(){const e=d("highContrast");e!==void 0&&(I=e);const t=d("reducedMotion");t!==void 0&&(B=t)}function Cs(){const e=document.getElementById("high-contrast-toggle");e&&(e.checked=I,e.addEventListener("change",()=>{xt()}));const t=document.getElementById("reduced-motion-toggle");t&&(t.checked=B,t.addEventListener("change",()=>{Pt()})),window.matchMedia("(prefers-reduced-motion: reduce)").addEventListener("change",n=>{n.matches&&Os(!0)}),window.matchMedia("(prefers-contrast: more)").addEventListener("change",n=>{n.matches&&$s(!0)})}function ae(){I?document.body.classList.add(lt):document.body.classList.remove(lt),B?document.body.classList.add(ut):document.body.classList.remove(ut)}function xt(){I=!I,r("highContrast",I),ae();const e=document.getElementById("high-contrast-toggle");return e&&(e.checked=I),I}function Pt(){B=!B,r("reducedMotion",B),ae();const e=document.getElementById("reduced-motion-toggle");return e&&(e.checked=B),B}function $s(e){I=e,r("highContrast",e),ae();const t=document.getElementById("high-contrast-toggle");t&&(t.checked=e)}function Os(e){B=e,r("reducedMotion",e),ae();const t=document.getElementById("reduced-motion-toggle");t&&(t.checked=e)}function Ds(){return I}function ge(){return B}const xs=1e3,Ps=60;let D=!1,be=null,g=null,He=0,ke=0,U=[],mt=0,pe=1/0,he=0;function Ns(e=!1){D=e,Fs(),D&&Nt()}function Fs(){if(document.getElementById("fps-display")){g=document.getElementById("fps-display");return}g=document.createElement("div"),g.id="fps-display",g.className=D?"fps-display":"fps-display hidden",g.innerHTML=`
        <div class="fps-current">FPS: --</div>
        <div class="fps-avg">Avg: --</div>
        <div class="fps-range">Min: -- | Max: --</div>
    `;const e=document.createElement("style");e.textContent=`
        .fps-display {
            position: fixed;
            top: 0;
            right: 0;
            background-color: rgba(0, 0, 0, 0.7);
            color: #00ff00;
            padding: 5px 10px;
            font-family: monospace;
            font-size: 12px;
            z-index: 9999;
            border-bottom-left-radius: 5px;
        }
        
        .fps-display.hidden {
            display: none;
        }
        
        .fps-current {
            font-weight: bold;
        }
        
        .fps-avg, .fps-range {
            font-size: 10px;
            opacity: 0.8;
        }
    `,document.head.appendChild(e),document.body.appendChild(g)}function Nt(){g&&g.classList.remove("hidden"),ke=0,U=[],He=performance.now(),pe=1/0,he=0,cancelAnimationFrame(be),be=requestAnimationFrame(Ft),setInterval(Us,xs)}function Ft(e){ke++,be=requestAnimationFrame(Ft)}function Us(){if(!D||!g)return;const e=performance.now(),t=e-He,n=Math.round(ke*1e3/t);U.push(n),U.length>Ps&&U.shift(),mt=Math.round(U.reduce((s,o)=>s+o,0)/U.length),pe=Math.min(pe,n),he=Math.max(he,n),g.querySelector(".fps-current").textContent=`FPS: ${n}`,g.querySelector(".fps-avg").textContent=`Avg: ${mt}`,g.querySelector(".fps-range").textContent=`Min: ${pe} | Max: ${he}`,ke=0,He=e,n<30?g.style.color="#ff0000":n<50?g.style.color="#ffff00":g.style.color="#00ff00"}function Ut(){return D=!D,D?Nt():(g&&g.classList.add("hidden"),cancelAnimationFrame(be)),D}function _s(){Ws()}function Ws(){const e=document.getElementById("back-from-settings");e&&e.addEventListener("click",Vs);const t=document.querySelectorAll(".tab-btn");t.forEach(A=>{A.addEventListener("click",()=>{const ot=A.getAttribute("data-tab");ot&&(Wt(ot),a("click"),t.forEach(it=>{it.setAttribute("aria-selected",it===A)}))})}),ls(),ms();const n=document.getElementById("sound-toggle-setting");n&&(n.checked=tn(),n.addEventListener("change",()=>{at(n.checked),a("click")}));const s=document.getElementById("sound-volume");s&&(s.value=an()*100,s.addEventListener("input",()=>{on(s.value/100)}));const o=document.getElementById("ambient-toggle-setting");o&&(o.checked=sn(),o.addEventListener("change",()=>{nn(o.checked),a("click")}));const i=document.getElementById("ambient-volume");i&&(i.value=rn()*100,i.addEventListener("input",()=>{cn(i.value/100)}));const c=document.getElementById("sound-style-retro"),m=document.getElementById("sound-style-modern");if(c&&m){const A=dn();c.checked=A==="retro",m.checked=A==="modern",c.addEventListener("change",()=>{c.checked&&(ct("retro"),Pe())}),m.addEventListener("change",()=>{m.checked&&(ct("modern"),Pe())})}const v=document.getElementById("test-sound-btn");v&&v.addEventListener("click",()=>{a("win")});const p=document.getElementById("ai-mode-select");p&&(p.value=G(),ft(G()),p.addEventListener("change",()=>{const A=p.value;In(A),ft(A),a("click")}));const x=document.getElementById("speed-mode-toggle");x&&(x.checked=Q(),x.addEventListener("change",()=>{An(x.checked),a("click"),_t()}));const h=document.getElementById("bonus-rounds-toggle");h&&(h.checked=Rt(),h.addEventListener("change",()=>{xn(h.checked),a("click")}));const Z=document.getElementById("fps-toggle");Z&&Z.addEventListener("change",()=>{Ut(),a("click")});const $=document.getElementById("high-contrast-toggle");$&&($.checked=Ds(),$.addEventListener("change",()=>{xt(),a("click")}));const Te=document.getElementById("reduced-motion-toggle");Te&&(Te.checked=ge(),Te.addEventListener("change",()=>{Pt(),a("click")}));const tt=document.getElementById("reset-stats-settings-btn");tt&&tt.addEventListener("click",()=>{confirm("Are you sure you want to reset your statistics?")&&(_e(),a("click"))});const nt=document.getElementById("reset-achievements-btn");nt&&nt.addEventListener("click",()=>{confirm("Are you sure you want to reset your achievements?")&&(Fe(),We(),a("click"))});const st=document.getElementById("delete-all-data-btn");st&&st.addEventListener("click",()=>{confirm("Are you sure you want to delete ALL game data? This cannot be undone.")&&(yt(),ps(),Fe(),_e(),We(),Qe("day"),at(!0),a("click"),alert("All data has been deleted. The game will now reload."),window.location.reload())})}function _t(){const e=document.getElementById("game-info-banner"),t=document.getElementById("game-info-text"),n=document.querySelector(".game-info-banner-icon");!e||!t||!n||(Q()?(e.classList.remove("hidden"),e.classList.add("speed-mode"),t.textContent="Speed Mode Active",n.textContent="⚡"):e.classList.add("hidden"))}function ft(e){const t=document.getElementById("ai-mode-description");let n="",s="";switch(e){case"cheeky":n="Cheeky Mode",s="This AI sometimes copies your last move (40% chance).";break;case"predictive":n="Predictive Mode",s="This AI analyzes your moves and tries to counter your most used choices.";break;case"random":default:n="Random Mode",s="AI picks a move randomly each turn.";break}t&&(t.innerHTML=`
            <h4>${n}</h4>
            <p>${s}</p>
        `)}function Wt(e){document.querySelectorAll(".tab-content").forEach(o=>{o.classList.remove("active"),o.setAttribute("aria-hidden","true")});const n=document.getElementById(`${e}-tab`);n&&(n.classList.add("active"),n.setAttribute("aria-hidden","false")),document.querySelectorAll(".tab-btn").forEach(o=>{o.classList.remove("active"),o.setAttribute("aria-selected","false"),o.getAttribute("data-tab")===e&&(o.classList.add("active"),o.setAttribute("aria-selected","true"))})}function Vt(){document.getElementById("landing-page").classList.add("hidden"),document.getElementById("game-screen").classList.add("hidden"),document.getElementById("results-screen").classList.add("hidden"),document.getElementById("stats-screen").classList.add("hidden"),document.getElementById("settings-screen").classList.remove("hidden"),Wt("profile"),a("click")}function Vs(){document.getElementById("settings-screen").classList.add("hidden"),document.getElementById("landing-page").classList.remove("hidden"),a("click")}const et="1.0";function Hs(){try{const e=js();e.metadata={version:et,exportDate:new Date().toISOString(),game:"RockPaperBattle"};const t=JSON.stringify(e,null,2),n=`data:text/json;charset=utf-8,${encodeURIComponent(t)}`,s=document.createElement("a");return s.setAttribute("href",n),s.setAttribute("download",`rock-paper-battle-save-${qs(new Date)}.json`),document.body.appendChild(s),s.click(),document.body.removeChild(s),!0}catch(e){return console.error("Failed to export game data:",e),!1}}function qs(e){const t=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0");return`${t}-${n}-${s}`}function js(){const e={};return Object.keys(localStorage).forEach(n=>{if(n.startsWith("RockPaperBattle_")||n==="hasRunBefore")try{e[n]=JSON.parse(localStorage.getItem(n))}catch{e[n]=localStorage.getItem(n)}}),e}function Ys(e){return new Promise((t,n)=>{if(!e){n({success:!1,message:"No file provided"});return}if(e.type!=="application/json"&&!e.name.endsWith(".json")){n({success:!1,message:"Invalid file type. Please select a JSON file"});return}const s=new FileReader;s.onload=o=>{try{const i=JSON.parse(o.target.result),c=Gs(i);if(!c.valid){n({success:!1,message:c.message});return}confirm("This will replace your current game data. Continue?")?(Js(i),t({success:!0,message:"Game data imported successfully!",stats:zs(i)})):n({success:!1,message:"Import cancelled by user"})}catch(i){n({success:!1,message:`Failed to import data: ${i.message}`})}},s.onerror=()=>{n({success:!1,message:"Error reading file"})},s.readAsText(e)})}function Gs(e){if(!e.metadata)return{valid:!1,message:"Invalid save file: Missing metadata"};if(e.metadata.game!=="RockPaperBattle")return{valid:!1,message:"Invalid save file: Not a Rock Paper Battle save file"};const t=e.metadata.version||"0";return Ks(t)?{valid:!0}:{valid:!1,message:`Incompatible save file version: ${t} (current: ${et})`}}function Ks(e){const t=et.split(".")[0],n=e.split(".")[0];return t===n}function Js(e){delete e.metadata,yt(),Object.entries(e).forEach(([t,n])=>{try{localStorage.setItem(t,typeof n=="string"?n:JSON.stringify(n))}catch(s){console.error(`Failed to import key ${t}:`,s)}})}function zs(e){const t={totalItems:Object.keys(e).length-1,achievements:0,stats:!1,profile:!1};if(e.RockPaperBattle_achievements){const n=e.RockPaperBattle_achievements;t.achievements=Object.values(n).filter(s=>s.unlocked).length}return e.RockPaperBattle_stats&&(t.stats=!0),e.RockPaperBattle_profile&&(t.profile=!0),t}let y=null;function Ht(){Qs()}function Qs(){const e=document.getElementById("loading-bar"),t=document.getElementById("loading-text");Gt(n=>{e&&(e.style.width=`${n}%`),t&&(t.textContent=`Loading game assets: ${n}%`)},()=>{t&&(t.textContent="Ready to play!"),setTimeout(Zs,500)})}function Zs(){const e=document.getElementById("loading-screen");e&&(e.classList.add("fade-out"),setTimeout(()=>{e.style.display="none"},500)),C("landing-page"),Zt(),ds(),us(),ln(),fn(),Ge(),bn(),Es(),Ln(),Dn(),_s(),As(),Ns(!1),Xs(),no(),so(),to(),eo()}function Xs(){jt({startEndlessMode:()=>{y="endless",Yn(),a("click"),Ue("Endless"),_t()},backToMenu:()=>{y==="endless"?Zn():y==="bestOf5"&&as(),V(),N()},playAgain:()=>{y==="endless"?Xn():y==="bestOf5"&&cs(),V()},makeMove:h=>{N(),y==="endless"?Ee(h):y==="bestOf5"&&Ve(h),S()}});const e=document.getElementById("best-of-5-btn");e&&e.addEventListener("click",()=>{y="bestOf5",ts(),a("click"),Ue("Best of 5");const h=document.getElementById("game-info-banner");h&&h.classList.add("hidden")});const t=document.getElementById("reset-scores");t&&t.addEventListener("click",()=>{y==="endless"?es():y==="bestOf5"&&rs(),V()});const n=document.getElementById("sound-toggle");n&&n.addEventListener("click",en);const s=document.getElementById("stats-btn");s&&s.addEventListener("click",()=>{gt(),pn()});const o=document.getElementById("back-from-stats");o&&o.addEventListener("click",hn);const i=document.getElementById("reset-stats-btn");i&&i.addEventListener("click",()=>{confirm("Are you sure you want to reset all stats and achievements?")&&(_e(),Fe(),We(),gt(),a("click"))});const c=document.getElementById("settings-btn");c&&c.addEventListener("click",Vt);const m=document.getElementById("fire-move-btn");m&&m.addEventListener("click",()=>{N();const h=m.getAttribute("data-move");y==="endless"?Ee(h):y==="bestOf5"&&Ve(h),S()});const v=document.getElementById("fps-toggle");v&&v.addEventListener("change",()=>{Ut(),a("click")});const p=document.getElementById("export-data-btn");p&&p.addEventListener("click",()=>{Hs(),a("click")});const x=document.getElementById("import-data-file");x&&x.addEventListener("change",h=>{const Z=h.target.files[0];Z&&Ys(Z).then($=>{alert(`Import successful! Imported ${$.stats.totalItems} items including ${$.stats.achievements} achievements.`),window.location.reload()}).catch($=>{alert(`Import failed: ${$.message}`)})}),document.addEventListener("click",S),document.addEventListener("mousemove",S),document.addEventListener("keydown",S)}function eo(){document.addEventListener("keydown",e=>{const t=document.getElementById("game-screen");if(t&&!t.classList.contains("hidden")&&(e.key==="Enter"||e.key===" ")&&document.activeElement.classList.contains("move-btn")){e.preventDefault();const n=document.activeElement.getAttribute("data-move");n&&(N(),y==="endless"?Ee(n):y==="bestOf5"&&Ve(n),S())}if(e.key==="Enter"||e.key===" "){if(document.activeElement.classList.contains("avatar-option")){e.preventDefault();const n=document.activeElement.getAttribute("data-avatar");n&&Ot(n)}if(document.activeElement.classList.contains("theme-option")){e.preventDefault();const n=document.activeElement.getAttribute("data-theme");n&&Qe(n)}}})}function to(){window.showWinAnimation=function(){if(ge())return;const e=document.querySelector(".confetti-container");if(!e)return;e.innerHTML="";const t=["#ff0000","#00ff00","#0000ff","#ffff00","#ff00ff","#00ffff"];for(let n=0;n<50;n++){const s=document.createElement("div");s.className="confetti-piece",s.style.left=`${Math.random()*100}%`,s.style.top=`${Math.random()*50}%`,s.style.backgroundColor=t[Math.floor(Math.random()*t.length)],s.style.setProperty("--confetti-dx",`${(Math.random()-.5)*300}px`),s.style.setProperty("--confetti-rotate",`${Math.random()*360}deg`),e.appendChild(s)}setTimeout(()=>{e.innerHTML=""},2e3)},window.showLossAnimation=function(e){!e||ge()||(e.classList.add("shake-effect"),setTimeout(()=>{e.classList.remove("shake-effect")},500))},window.showDrawAnimation=function(e){!e||ge()||(e.classList.add("draw-effect"),setTimeout(()=>{e.classList.remove("draw-effect")},1e3))}}function gt(){const e=document.getElementById("achievements-list");if(!e)return;const t=mn();e.innerHTML="",t.forEach(n=>{const s=document.createElement("div");s.className=`achievement-item ${n.unlocked?"unlocked":"locked"}`,s.setAttribute("role","listitem");const o=n.unlocked?"Unlocked":"Locked";s.setAttribute("aria-label",`${n.name} - ${o} - ${n.description}`),s.innerHTML=`
            <div class="achievement-icon">${n.icon}</div>
            <div class="achievement-content">
                <h4>${n.name}</h4>
                <p>${n.description}</p>
            </div>
        `,e.appendChild(s)})}function no(){d()}function so(){d("hasRunBefore")||(r("hasRunBefore",!0),setTimeout(()=>{Vt()},1e3))}function oo(){Be()}window.addEventListener("DOMContentLoaded",Ht);window.addEventListener("beforeunload",oo);(document.readyState==="interactive"||document.readyState==="complete")&&Ht();
