(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const c of i.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function n(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(o){if(o.ep)return;o.ep=!0;const i=n(o);fetch(o.href,i)}})();const Yt={rock:"✊",paper:"✋",scissors:"✌️",fire:"🔥"};function vt(e,t){return e===t?"draw":e==="rock"&&t==="scissors"||e==="paper"&&t==="rock"||e==="scissors"&&t==="paper"?"win":e==="fire"?t==="scissors"||t==="paper"?"win":"lose":t==="fire"?e==="scissors"||e==="paper"?"lose":"win":"lose"}function Y(e){return Yt[e]||"❓"}function yt(e,t,n){const s=Y(t),o=Y(n);return e==="win"?t==="fire"&&(n==="scissors"||n==="paper")?`${s} Fire burns ${o}! You win!`:t==="rock"&&n==="fire"?`${s} Rock smothers ${o}! You win!`:`${s} beats ${o}! You win!`:e==="lose"?n==="fire"&&(t==="scissors"||t==="paper")?`${o} Fire burns ${s}! You lose!`:n==="rock"&&t==="fire"?`${o} Rock smothers ${s}! You lose!`:`${o} beats ${s}! You lose!`:`${s} ties with ${o}! It's a draw!`}const u={landingPage:document.getElementById("landing-page"),gameScreen:document.getElementById("game-screen"),resultsScreen:document.getElementById("results-screen"),endlessModeBtn:document.getElementById("endless-mode-btn"),bestOf5Btn:document.getElementById("best-of-5-btn"),backToMenuBtn:document.getElementById("back-to-menu"),backToMenuResultBtn:document.getElementById("back-to-menu-btn"),playAgainBtn:document.getElementById("play-again-btn"),moveButtons:document.querySelectorAll(".move-btn"),themeToggleBtn:document.getElementById("theme-toggle-btn"),resetScoresBtn:document.getElementById("reset-scores"),soundToggleBtn:document.getElementById("sound-toggle"),playerScore:document.getElementById("player-score"),aiScore:document.getElementById("ai-score"),playerMoveDisplay:document.getElementById("player-move-display"),aiMoveDisplay:document.getElementById("ai-move-display"),resultTitle:document.getElementById("result-title"),resultMessage:document.getElementById("result-message"),playerMoveResult:document.getElementById("player-move"),aiMoveResult:document.getElementById("ai-move")};function C(e){u.landingPage.classList.add("hidden"),u.gameScreen.classList.add("hidden"),u.resultsScreen.classList.add("hidden");const t=document.getElementById(e);t?t.classList.remove("hidden"):console.error("Invalid section ID:",e)}function se(e,t){u.playerScore.textContent=e,u.aiScore.textContent=t}function Be(e,t){u.playerMoveDisplay.textContent=Y(e),u.aiMoveDisplay.textContent=Y(t)}function Et(e,t,n,s){let o,i;switch(e){case"win":o="You Win!",i="win";break;case"lose":o="You Lose!",i="lose";break;case"draw":o="It's a Draw!",i="draw";break;default:o="Game Result",i=""}u.resultTitle.textContent=o,u.resultMessage.textContent=t,u.resultMessage.className=`result-message ${i}`,u.playerMoveResult.textContent=Y(n),u.aiMoveResult.textContent=Y(s),C("results-screen")}function Gt(e){e.startEndlessMode&&u.endlessModeBtn&&u.endlessModeBtn.addEventListener("click",e.startEndlessMode),e.backToMenu&&(u.backToMenuBtn&&u.backToMenuBtn.addEventListener("click",e.backToMenu),u.backToMenuResultBtn&&u.backToMenuResultBtn.addEventListener("click",e.backToMenu)),e.playAgain&&u.playAgainBtn&&u.playAgainBtn.addEventListener("click",e.playAgain),e.makeMove&&u.moveButtons&&u.moveButtons.forEach(t=>{t.addEventListener("click",()=>{const n=t.getAttribute("data-move");e.makeMove(n)})}),e.toggleTheme&&u.themeToggleBtn&&u.themeToggleBtn.addEventListener("click",e.toggleTheme),e.resetScores&&u.resetScoresBtn&&u.resetScoresBtn.addEventListener("click",e.resetScores)}const Ye="rock-paper-battle",xe={theme:"day",soundEnabled:!0,soundVolume:.5,ambientEnabled:!0,ambientVolume:.3,audioStyle:"retro",stats:{wins:0,losses:0,draws:0,longestWinStreak:0,bestMode:""},achievements:{winStreak3:!1,flawlessVictory:!1,roundsPlayed10:!1},profile:{name:"Player",avatar:"👤"},unlocks:{secretMoveUnlocked:!1,secretMoveRevealed:!1},currentWinStreak:0};let P=null;function d(e=null){if(!P)try{const t=localStorage.getItem(Ye);P=t?JSON.parse(t):{...xe}}catch(t){console.error("Error loading data from localStorage:",t),P={...xe}}return e?P[e]:P}function r(e,t){const n=d();n[e]=t;try{localStorage.setItem(Ye,JSON.stringify(n)),P=n}catch(s){console.error("Error saving data to localStorage:",s)}}function de(e){if(!["wins","losses","draws"].includes(e)){console.error(`Invalid stat name: ${e}`);return}const t=d("stats")||{};t[e]=(t[e]||0)+1,r("stats",t)}function wt(){try{localStorage.removeItem(Ye),P={...xe}}catch(e){console.error("Error clearing data from localStorage:",e)}}const A={audio:["click.wav","win.wav","lose.wav","draw.wav","gameStart.wav","gameWin.wav","gameLose.wav","gameDraw.wav","countdown.wav","tick.wav","timeUp.wav","bonusRound.wav","chaos.wav"],ambientAudio:["wind.wav","hum.wav","lo-fi-loop.wav"],images:["logo.webp"],icons:["favicon-96x96.png","apple-touch-icon.png","favicon.svg","web-app-manifest-192x192.png","web-app-manifest-512x512.png"]},z={audio:{},images:{},icons:{}};let Pe=0,le=0,Ne=!1,ue=null,me=null;function Kt(){return d("audioStyle")||"retro"}function Jt(e=null,t=null){Ne||(Ne=!0,ue=e,me=t,Pe=A.audio.length+A.ambientAudio.length+A.images.length+A.icons.length,le=0,A.audio.forEach(n=>{Ee(n)}),A.ambientAudio.forEach(n=>{Ee(n,!0)}),A.images.forEach(n=>{zt(n)}),A.icons.forEach(n=>{Qt(n)}))}function Ee(e,t=!1){const n=Kt(),s=t?`./audio/${n}/ambient/${e}`:`./audio/${n}/${e}`,o=new Audio(s);o.addEventListener("canplaythrough",()=>{G()},{once:!0}),o.addEventListener("error",()=>{console.warn(`Failed to load audio file: ${e}`),G()},{once:!0}),o.load();const i=t?`ambient_${e.split(".")[0]}`:e.split(".")[0];z.audio[i]=o}function zt(e){const t=new Image;t.onload=()=>{G()},t.onerror=()=>{console.warn(`Failed to load image file: ${e}`),G()},t.src=`./images/${e}`;const n=e.split(".")[0];z.images[n]=t}function Qt(e){const t=new Image;t.onload=()=>{G()},t.onerror=()=>{console.warn(`Failed to load icon file: ${e}`),G()},t.src=`./icons/${e}`;const n=e.split(".")[0];z.icons[n]=t}function G(e){le++;const t=Math.floor(le/Pe*100);ue&&typeof ue=="function"&&ue(t),le>=Pe&&(Ne=!1,me&&typeof me=="function"&&me())}function bt(e,t=!1){const n=t?`ambient_${e}`:e;return!!z.audio[n]}function kt(e,t=!1){const n=t?`ambient_${e}`:e;return z.audio[n]||null}function Fe(){z.audio={},A.audio.forEach(e=>{Ee(e)}),A.ambientAudio.forEach(e=>{Ee(e,!0)})}const Zt={click:"click.wav",win:"win.wav",lose:"lose.wav",draw:"draw.wav",gameStart:"gameStart.wav",gameWin:"gameWin.wav",gameLose:"gameLose.wav",gameDraw:"gameDraw.wav",countdown:"countdown.wav",tick:"tick.wav",timeUp:"timeUp.wav",bonusRound:"bonusRound.wav",chaos:"chaos.wav"},Xt={wind:"wind.wav",hum:"hum.wav",lofi:"lo-fi-loop.wav"};let M=!0,H=!0,K=.5,N=.3,v=null,U="retro";function en(){M=d("soundEnabled")!==!1,H=d("ambientEnabled")!==!1,U=d("audioStyle")||"retro";const e=d("soundVolume");e!=null&&(K=parseFloat(e));const t=d("ambientVolume");t!=null&&(N=parseFloat(t)),Ge(),H&&setTimeout(()=>{Le()},1e3),console.log("Sound settings initialized:",{soundEnabled:M,ambientEnabled:H,volume:K,ambientVolume:N,audioStyle:U})}function Ge(){const e=document.getElementById("sound-toggle");e&&(e.textContent=M?"🔊":"🔇",e.title=M?"Sound On (Click to Mute)":"Sound Off (Click to Unmute)")}function a(e){if(!M)return;const t=Zt[e];if(!t)return;let n;bt(e)&&(n=kt(e),n&&(n=n.cloneNode())),n||(n=new Audio(`./audio/${U}/${t}`)),n.volume=K,n.play().catch(s=>console.warn("Error playing sound:",s))}function Le(e="lofi"){if(!H)return;ce();const t=Xt[e];t&&(bt(e,!0)?(v=kt(e,!0),v&&(v=v.cloneNode())):v=new Audio(`./audio/${U}/ambient/${t}`),v&&(v.volume=N,v.loop=!0,v.play().catch(n=>console.warn("Error playing ambient sound:",n))))}function ce(){v&&(v.pause(),v.currentTime=0,v=null)}function tn(){M=!M,r("soundEnabled",M),Ge(),M&&a("click")}function rt(e){M=e,r("soundEnabled",e),Ge()}function $e(){return M}function nn(e){H=e,r("ambientEnabled",e),e?Le():ce()}function sn(){return H}function on(e){K=Math.max(0,Math.min(1,e)),r("soundVolume",K)}function an(){return K}function cn(e){N=Math.max(0,Math.min(1,e)),r("ambientVolume",N),v&&(v.volume=N)}function rn(){return N}function dt(e){e!=="modern"&&e!=="retro"||(U=e,r("audioStyle",U),Fe())}function dn(){return U}const Ue={winStreak3:{id:"winStreak3",name:"3 Wins in a Row",description:"Win 3 games in a row",icon:"🥉"},flawlessVictory:{id:"flawlessVictory",name:"Flawless Victory",description:"Win all rounds in a Best of 5 match",icon:"🥇"},roundsPlayed10:{id:"roundsPlayed10",name:"10 Total Rounds Played",description:"Play 10 or more rounds",icon:"📊"}};let W=0;function ln(){d("achievements")||r("achievements",{winStreak3:!1,flawlessVictory:!1,roundsPlayed10:!1}),W=d("currentWinStreak")||0}function Ke(e,t={},n="endless"){e==="win"?W++:e==="lose"&&(W=0),r("currentWinStreak",W),W>=3&&Oe("winStreak3"),n==="bestOf5"&&t.gameOver&&t.playerScore>=3&&t.aiScore===0&&Oe("flawlessVictory");const s=d("stats");(s.wins||0)+(s.losses||0)+(s.draws||0)>=10&&Oe("roundsPlayed10")}function Oe(e){if(!Ue[e]){console.error(`Achievement "${e}" does not exist`);return}const t=d("achievements");t[e]||(t[e]=!0,r("achievements",t),a("win"),un(Ue[e]))}function un(e){const t=document.createElement("div");t.className="achievement-notification",t.innerHTML=`
        <div class="achievement-icon">${e.icon}</div>
        <div class="achievement-content">
            <h3>Achievement Unlocked!</h3>
            <p class="achievement-name">${e.name}</p>
            <p class="achievement-description">${e.description}</p>
        </div>
    `,document.body.appendChild(t),setTimeout(()=>{t.classList.add("show")},100),setTimeout(()=>{t.classList.remove("show"),setTimeout(()=>{document.body.removeChild(t)},500)},5e3)}function mn(){const e=d("achievements")||{};return Object.values(Ue).map(t=>({...t,unlocked:e[t.id]||!1}))}function Ve(){r("achievements",{winStreak3:!1,flawlessVictory:!1,roundsPlayed10:!1}),W=0,r("currentWinStreak",0)}function fn(){d("stats")||r("stats",{wins:0,losses:0,draws:0,longestWinStreak:0,bestMode:""})}function St(e){const t=d("stats");e>t.longestWinStreak&&(t.longestWinStreak=e,r("stats",t))}function _e(e){const t=d("stats");t.bestMode=e,r("stats",t)}function It(){const e=d("stats")||{wins:0,losses:0,draws:0,longestWinStreak:0,bestMode:"None"},t=document.getElementById("stats-wins"),n=document.getElementById("stats-losses"),s=document.getElementById("stats-draws"),o=document.getElementById("stats-streak"),i=document.getElementById("stats-best-mode"),c=document.getElementById("stats-win-rate"),m=document.getElementById("stats-total-games");t&&(t.textContent=e.wins),n&&(n.textContent=e.losses),s&&(s.textContent=e.draws),o&&(o.textContent=e.longestWinStreak),i&&(i.textContent=e.bestMode||"None");const y=e.wins+e.losses+e.draws,p=y>0?Math.round(e.wins/y*100):0;c&&(c.textContent=`${p}%`),m&&(m.textContent=y),gn(e,y)}function gn(e,t){const n=document.getElementById("stats-wins-bar"),s=document.getElementById("stats-losses-bar"),o=document.getElementById("stats-draws-bar");if(!n||!s||!o)return;const i=t>0?Math.max(2,e.wins/t*100):2,c=t>0?Math.max(2,e.losses/t*100):2,m=t>0?Math.max(2,e.draws/t*100):2;n.style.width=`${i}%`,s.style.width=`${c}%`,o.style.width=`${m}%`}function We(){r("stats",{wins:0,losses:0,draws:0,longestWinStreak:0,bestMode:""}),It(),a("click")}function pn(){document.getElementById("landing-page").classList.add("hidden"),document.getElementById("game-screen").classList.add("hidden"),document.getElementById("results-screen").classList.add("hidden"),document.getElementById("stats-screen").classList.remove("hidden"),It(),a("click")}function hn(){document.getElementById("stats-screen").classList.add("hidden"),document.getElementById("landing-page").classList.remove("hidden"),a("click")}const vn=10;let Q=!1;function Je(){Q=(d("unlocks")||{}).secretMoveUnlocked||!1,yn(),ze()}function yn(){if(Q)return;((d("stats")||{}).wins||0)>=vn&&En()}function En(){Q=!0;const e=d("unlocks")||{};e.secretMoveUnlocked=!0,r("unlocks",e),ze(),setTimeout(wn,1e3)}function ze(){const e=document.getElementById("fire-move-btn");if(e)if(Q){e.classList.remove("hidden");const t=d("unlocks")||{};t.secretMoveUnlocked&&!t.secretMoveRevealed&&(e.classList.add("fire-reveal"),t.secretMoveRevealed=!0,r("unlocks",t),setTimeout(()=>{e.classList.add("fire-glow"),setTimeout(()=>{e.classList.remove("fire-glow")},5e3)},1e3))}else e.classList.add("hidden")}function wn(){const e=document.createElement("div");e.className="achievement-notification",e.innerHTML=`
        <div class="achievement-icon">🔥</div>
        <div class="achievement-content">
            <h3>New Move Unlocked!</h3>
            <p class="achievement-name">Fire Move</p>
            <p class="achievement-description">You've unlocked the secret Fire move!</p>
        </div>
    `,document.body.appendChild(e),a("win"),setTimeout(()=>{e.classList.add("show")},100),setTimeout(()=>{e.classList.remove("show"),setTimeout(()=>{document.body.removeChild(e)},500)},5e3)}function oe(){return Q}function He(){Q=!1;const e=d("unlocks")||{};e.secretMoveUnlocked=!1,e.secretMoveRevealed=!1,r("unlocks",e),ze()}const b={RANDOM:"random",CHEEKY:"cheeky",PREDICTIVE:"predictive"};let Z=b.RANDOM;const O={rock:0,paper:0,scissors:0,fire:0};let te=null;function bn(){const e=d("aiMode");e&&Object.values(b).includes(e)?Z=e:r("aiMode",b.RANDOM),Me()}function Me(){O.rock=0,O.paper=0,O.scissors=0,O.fire=0,te=null}function Bt(e){O[e]!==void 0&&(O[e]++,te=e)}function Lt(e){switch(Z){case b.CHEEKY:return kn(e);case b.PREDICTIVE:return Sn(e);case b.RANDOM:default:return ie(e)}}function ie(e){const t=Math.floor(Math.random()*e.length);return e[t]}function kn(e){return te&&e.includes(te)&&Math.random()<.4?te:ie(e)}function Sn(e){let t="rock",n=0;for(const[i,c]of Object.entries(O))c>n&&(n=c,t=i);if(Object.values(O).reduce((i,c)=>i+c,0)<3)return ie(e);let o;switch(t){case"rock":o="paper";break;case"paper":o="scissors";break;case"scissors":o="rock";break;case"fire":o="rock";break;default:o="rock"}return e.includes(o)?o:ie(e)}function In(e){Object.values(b).includes(e)?(Z=e,r("aiMode",e),Me()):console.error(`Invalid AI mode: ${e}`)}function J(){return Z}function Mt(){switch(Z){case b.CHEEKY:return"Cheeky";case b.PREDICTIVE:return"Predictive";case b.RANDOM:default:return"Random"}}function At(){switch(Z){case b.CHEEKY:return"😏";case b.PREDICTIVE:return"🧠";case b.RANDOM:default:return"🤖"}}const Rt=3e3,Tt=50,Bn=1e3;let ae=!1,fe=null,ge=null,V=0,pe=null,k=null,we=!1;function Ln(){const e=d("speedMode");e!==void 0?ae=e:(r("speedMode",!1),ae=!1),Mn()}function Mn(){if(document.getElementById("speed-timer")){k=document.getElementById("speed-timer");return}const e=document.createElement("div");e.id="speed-timer-container",e.className="speed-timer-container hidden",k=document.createElement("div"),k.id="speed-timer",k.className="speed-timer",e.appendChild(k);const t=document.getElementById("game-screen");if(t){const n=t.querySelector(".game-header");n?n.insertAdjacentElement("afterend",e):t.insertAdjacentElement("afterbegin",e)}else document.body.appendChild(e)}function X(){return ae}function An(e){ae=e,r("speedMode",e)}function Rn(e=Rt,t=null){if(!ae||we)return!1;pe=t,V=e,we=!0;const n=document.getElementById("speed-timer-container");return n&&n.classList.remove("hidden"),k&&(k.style.width="100%",k.classList.remove("warning")),F(),fe=setTimeout(()=>{Tn()},e),ge=setInterval(()=>{Cn()},Tt),a("countdown"),!0}function F(){fe&&(clearTimeout(fe),fe=null),ge&&(clearInterval(ge),ge=null),we=!1;const e=document.getElementById("speed-timer-container");e&&e.classList.add("hidden")}function Tn(){a("timeUp"),pe&&typeof pe=="function"&&pe(),F()}function Cn(){if(!k||!we)return;V-=Tt,V<0&&(V=0);const e=V/Rt*100;k.style.width=`${e}%`,V<=Bn&&!k.classList.contains("warning")&&(k.classList.add("warning"),a("tick"))}function $n(e){return ie(e)}const On=.2,T={DOUBLE_POINTS:"double-points",REVERSE_RULES:"reverse-rules",CHAOS_MODE:"chaos-mode"};let Ae=!0,R=null,ne={};function Dn(){const e=d("bonusEnabled");e!==void 0?Ae=e:r("bonusEnabled",!0)}function Ct(){return Ae}function xn(e){Ae=e,r("bonusEnabled",e)}function Pn(){return Ae?Math.random()<On:!1}function Nn(){R&&q();const e=Object.values(T),t=Math.floor(Math.random()*e.length),n=e[t];return Fn(n),n}function Fn(e){if(!Object.values(T).includes(e)){console.error(`Invalid bonus type: ${e}`);return}R=e,Un(e),Wn(e),a("bonusRound")}function Un(e){const t=document.querySelector(".game-area");switch(t&&(t.classList.add("bonus-round"),t.classList.add(e)),e){case T.CHAOS_MODE:Vn();break}}function Vn(){const e=document.querySelectorAll(".move-btn:not(.hidden)");if(e.length<2)return;ne={},e.forEach(n=>{const s=n.getAttribute("data-move");ne[s]=n.textContent}),Array.from(e).map(n=>n.getAttribute("data-move"));const t=Array.from(e).map(n=>n.textContent);for(let n=t.length-1;n>0;n--){const s=Math.floor(Math.random()*(n+1));[t[n],t[s]]=[t[s],t[n]]}e.forEach((n,s)=>{n.textContent=t[s],n.classList.add("chaos-mode-btn")}),a("chaos")}function q(){if(!R)return;const e=document.querySelector(".game-area");switch(e&&(e.classList.remove("bonus-round"),e.classList.remove(R)),R){case T.CHAOS_MODE:_n();break}R=null}function _n(){document.querySelectorAll(".move-btn").forEach(t=>{const n=t.getAttribute("data-move");ne[n]&&(t.textContent=ne[n]),t.classList.remove("chaos-mode-btn")}),ne={}}function Wn(e){let t,n,s;switch(e){case T.DOUBLE_POINTS:t="Double Points Round!",n="Win this round to earn double points!",s="🎯";break;case T.REVERSE_RULES:t="Reverse Rules!",n="The rules are reversed! Rock beats Paper, Paper beats Scissors, Scissors beats Rock!",s="🔁";break;case T.CHAOS_MODE:t="Chaos Mode!",n="Move labels are scrambled! Choose wisely!",s="🎲";break;default:t="Bonus Round!",n="Special rules apply this round!",s="🎁"}const o=document.createElement("div");o.className="bonus-notification",o.innerHTML=`
        <div class="bonus-notification-icon">${s}</div>
        <div class="bonus-notification-content">
            <h3>${t}</h3>
            <p>${n}</p>
        </div>
    `,document.body.appendChild(o),setTimeout(()=>{o.classList.add("show")},100),setTimeout(()=>{o.classList.remove("show"),setTimeout(()=>{document.body.removeChild(o)},500)},4e3)}function Hn(e,t,n){if(!R)return e;switch(R){case T.REVERSE_RULES:return qn(e,t,n);default:return e}}function qn(e,t,n){if(t===n)return"draw";if(t==="rock"&&n==="paper"||t==="paper"&&n==="scissors"||t==="scissors"&&n==="rock")return"win";if(t==="paper"&&n==="rock"||t==="scissors"&&n==="paper"||t==="rock"&&n==="scissors")return"lose";if(t==="fire"){if(n==="scissors"||n==="paper")return"win";if(n==="rock")return"lose"}if(n==="fire"){if(t==="scissors"||t==="paper")return"lose";if(t==="rock")return"win"}return e}function jn(){return R===T.DOUBLE_POINTS?2:1}const f={playerScore:0,aiScore:0,currentRound:0,lastPlayerMove:null,lastAiMove:null,lastResult:null,bonusRoundActive:!1,bonusType:null,timeoutMove:null};function Yn(){$t(),document.querySelector("#game-screen h2").textContent="Endless Mode",Gn();const e=d("stats");e?se(e.wins,e.losses):se(0,0),C("game-screen"),a("gameStart"),X()&&Qe()}function Qe(){X()&&Rn(3e3,()=>{const t=oe()?["rock","paper","scissors","fire"]:["rock","paper","scissors"],n=$n(t);f.timeoutMove=n,be(n,!0)})}function Gn(){const e=document.getElementById("ai-mode-indicator");if(e){e.className="ai-mode-indicator",e.textContent=At();const t=J();t==="random"?e.classList.add("ai-random-indicator"):t==="cheeky"?e.classList.add("ai-cheeky-indicator"):t==="predictive"&&e.classList.add("ai-predictive-indicator"),e.title=`${Mt()} AI Mode`}}function $t(){f.currentRound=0,f.lastPlayerMove=null,f.lastAiMove=null,f.lastResult=null,f.bonusRoundActive=!1,f.bonusType=null,f.timeoutMove=null,Be("",""),Me(),q()}function be(e,t=!1){Bt(e),!f.bonusRoundActive&&Ct()&&Pn()&&(f.bonusRoundActive=!0,f.bonusType=Nn());const s=oe()?["rock","paper","scissors","fire"]:["rock","paper","scissors"],o=Lt(s);let i=vt(e,o);f.bonusRoundActive&&(i=Hn(i,e,o)),f.lastPlayerMove=e,f.lastAiMove=o,f.lastResult=i,f.currentRound++,Be(e,o),Jn(i,t),a(i==="win"?"win":i==="lose"?"lose":"draw"),Ke(i,f,"endless"),oe()||Je();const c=yt(i,e,o);Kn(i),setTimeout(()=>{Et(i,c,e,o),f.bonusRoundActive&&(q(),f.bonusRoundActive=!1,f.bonusType=null)},1e3)}function Kn(e){const t=document.getElementById("player-move-display"),n=document.getElementById("ai-move-display");switch(e){case"win":window.showWinAnimation&&window.showWinAnimation();break;case"lose":window.showLossAnimation&&t&&window.showLossAnimation(t);break;case"draw":window.showDrawAnimation&&t&&n&&(window.showDrawAnimation(t),window.showDrawAnimation(n));break}}function Jn(e,t){const n=f.bonusRoundActive?jn():1;if(t&&e!=="win"&&(e="lose"),e==="win")for(let o=0;o<n;o++)de("wins");else de(e==="lose"?"losses":"draws");f.bonusRoundActive&&e==="win"&&zn();const s=d("stats");if(se(s.wins,s.losses),e==="win"){const o=d("currentWinStreak")||0;St(o)}Qn(e)}function zn(){const e=d("bonusRoundsWon")||0;r("bonusRoundsWon",e+1);const t=document.getElementById("stats-bonus-rounds");t&&(t.textContent=e+1)}function Qn(e){if(e!=="win")return;const t=J(),n=d("aiStats")||{random:{wins:0},cheeky:{wins:0},predictive:{wins:0}};n[t]||(n[t]={wins:0}),n[t].wins=(n[t].wins||0)+1,r("aiStats",n);const s=document.getElementById("stats-best-ai-mode");if(s){let o="random",i=0;for(const[y,p]of Object.entries(n))p.wins>i&&(i=p.wins,o=y);let c="Random",m="🤖";switch(o){case"cheeky":c="Cheeky",m="😏";break;case"predictive":c="Predictive",m="🧠";break;default:c="Random",m="🤖";break}s.textContent=`${m} ${c}`}}function Zn(){a("click"),C("landing-page"),F()}function Xn(){a("click"),C("game-screen"),X()&&Qe()}function es(){const e=d();e.stats.wins=0,e.stats.losses=0,e.stats.draws=0,r("stats",e.stats),se(0,0),$t(),r("currentWinStreak",0),a("click"),X()&&Qe()}const l={playerScore:0,aiScore:0,currentRound:0,maxRounds:5,lastPlayerMove:null,lastAiMove:null,lastResult:null,gameOver:!1};function ts(){Ze(),document.querySelector("#game-screen h2").textContent="Best of 5",ns(),C("game-screen"),a("gameStart")}function ns(){const e=document.getElementById("ai-mode-indicator");if(e){e.className="ai-mode-indicator",e.textContent=At();const t=J();t==="random"?e.classList.add("ai-random-indicator"):t==="cheeky"?e.classList.add("ai-cheeky-indicator"):t==="predictive"&&e.classList.add("ai-predictive-indicator"),e.title=`${Mt()} AI Mode`}}function Ze(){l.playerScore=0,l.aiScore=0,l.currentRound=0,l.lastPlayerMove=null,l.lastAiMove=null,l.lastResult=null,l.gameOver=!1,Be("",""),Ot(),Me()}function Ot(){se(l.playerScore,l.aiScore)}function qe(e){if(l.gameOver)return;Bt(e);const n=oe()?["rock","paper","scissors","fire"]:["rock","paper","scissors"],s=Lt(n),o=vt(e,s);l.lastPlayerMove=e,l.lastAiMove=s,l.lastResult=o,l.currentRound++,o==="win"?(l.playerScore++,a("win")):o==="lose"?(l.aiScore++,a("lose")):a("draw"),Ot(),Be(e,s);const i=yt(o,e,s),c=os();if(Ke(o,l,"bestOf5"),oe()||Je(),setTimeout(()=>{c?is():Et(o,i,e,s)},1e3),de(o==="win"?"wins":o==="lose"?"losses":"draws"),o==="win"){const m=d("currentWinStreak")||0;St(m),ss(o)}}function ss(e){if(e!=="win")return;const t=J(),n=d("aiStats")||{random:{wins:0},cheeky:{wins:0},predictive:{wins:0}};n[t]||(n[t]={wins:0}),n[t].wins=(n[t].wins||0)+1,r("aiStats",n);const s=document.getElementById("stats-best-ai-mode");if(s){let o="random",i=0;for(const[y,p]of Object.entries(n))p.wins>i&&(i=p.wins,o=y);let c="Random",m="🤖";switch(o){case"cheeky":c="Cheeky",m="😏";break;case"predictive":c="Predictive",m="🧠";break;default:c="Random",m="🤖";break}s.textContent=`${m} ${c}`}}function os(){return l.playerScore>=3||l.aiScore>=3||l.currentRound>=l.maxRounds?(l.gameOver=!0,!0):!1}function is(){const e=l.playerScore>l.aiScore,t=l.playerScore===l.aiScore;let n,s,o;t?(n="It's a Draw!",s=`Final Score: ${l.playerScore}-${l.aiScore}`,o="draw",a("gameDraw")):e?(n="You Win the Match!",s=`Final Score: ${l.playerScore}-${l.aiScore}`,o="win",a("gameWin"),_e("Best of 5"),l.aiScore===0&&Ke("win",l,"bestOf5")):(n="You Lose the Match!",s=`Final Score: ${l.playerScore}-${l.aiScore}`,o="lose",a("gameLose"));const i=document.getElementById("result-title"),c=document.getElementById("result-message");i.textContent=n,c.textContent=s,c.className=`result-message ${o}`,C("results-screen")}function as(){a("click"),C("landing-page")}function cs(){a("click"),l.gameOver&&Ze(),C("game-screen")}function rs(){Ze(),a("click")}const Re=["day","night","retro","neon"];let ke="day";function ds(){const e=d("theme");e&&Re.includes(e)&&(ke=e),Dt(ke)}function ls(){document.querySelectorAll(".theme-option").forEach(t=>{t.addEventListener("click",()=>{const n=t.getAttribute("data-theme");n&&Re.includes(n)&&(Xe(n),lt(n),a("click"))})}),lt(ke)}function lt(e){document.querySelectorAll(".theme-option").forEach(s=>{s.classList.remove("active")});const n=document.querySelector(`.theme-option[data-theme="${e}"]`);n&&n.classList.add("active")}function Xe(e){if(!Re.includes(e)){console.error(`Theme "${e}" is not valid`);return}ke=e,r("theme",e),Dt(e)}function Dt(e){document.body.classList.remove(...Re.map(t=>`theme-${t}`)),document.body.classList.add(`theme-${e}`)}const et={name:"Player",avatar:"👤"};let S={...et};function us(){const e=d("profile");e?S=e:r("profile",et),tt()}function ms(){document.querySelectorAll(".avatar-option").forEach(s=>{s.addEventListener("click",()=>{const o=s.getAttribute("data-avatar");o&&(xt(o),ut(o),a("click"))})});const t=document.getElementById("player-name-input");t&&(t.value=S.name);const n=document.getElementById("save-profile-btn");n&&n.addEventListener("click",fs),ut(S.avatar)}function ut(e){document.querySelectorAll(".avatar-option").forEach(s=>{s.classList.remove("selected")});const n=document.querySelector(`.avatar-option[data-avatar="${e}"]`);n&&(n.classList.add("selected"),n.classList.add("avatar-highlight"),setTimeout(()=>{n.classList.remove("avatar-highlight")},500))}function xt(e){S.avatar=e}function fs(){const e=document.getElementById("player-name-input");e&&e.value.trim()&&(S.name=e.value.trim()),r("profile",S),tt(),a("win"),gs()}function gs(){const e=document.getElementById("save-profile-btn");if(e){const t=e.textContent;e.textContent="Saved!",e.disabled=!0,setTimeout(()=>{e.textContent=t,e.disabled=!1},1500)}}function tt(){const e=document.getElementById("player-avatar"),t=document.getElementById("player-name");e&&(e.textContent=S.avatar),t&&(t.textContent=S.name);const n=document.getElementById("game-player-avatar"),s=document.getElementById("game-player-name");n&&(n.textContent=S.avatar),s&&(s.textContent=S.name)}function ps(){S={...et},r("profile",S),tt()}const hs=7e3,vs=1e3;let De=null,Te=!1,Pt=Date.now(),j=[];const ys=[".move-btn",".player-choice",".ai-choice"];function Es(){ws(),bs()}function ws(){document.addEventListener("mousemove",I),document.addEventListener("click",I),document.addEventListener("keydown",I),document.addEventListener("touchstart",I),document.addEventListener("touchmove",I)}function bs(){De&&clearInterval(De),De=setInterval(ks,vs)}function I(){Pt=Date.now(),Te&&Is()}function ks(){Date.now()-Pt>=hs&&!Te&&Ss()}function Ss(){Te=!0,Bs(),Ls(),d("ambientEnabled")!==!1&&Le()}function Is(){Te=!1,Ms(),ce()}function Bs(){j=[],ys.forEach(t=>{document.querySelectorAll(t).forEach(s=>{s.offsetParent!==null&&j.push(s)})});const e=document.querySelector("section:not(.hidden)");e&&j.push(e)}function Ls(){j.forEach((e,t)=>{e.classList.contains("idle-animation")||(e.classList.contains("move-btn")?(e.classList.add("idle-animation","idle-pulse"),e.style.animationDelay=`${t*.2}s`):e.classList.contains("player-choice")||e.classList.contains("ai-choice")?e.classList.add("idle-animation","idle-glow"):e.tagName.toLowerCase()==="section"&&e.classList.add("idle-animation","idle-background"))}),document.body.classList.add("idle")}function Ms(){j.forEach(t=>{t.classList.remove("idle-animation","idle-pulse","idle-glow","idle-background"),t.style.animationDelay=""}),document.querySelectorAll(".idle-animation").forEach(t=>{t.classList.remove("idle-animation","idle-pulse","idle-glow","idle-background"),t.style.animationDelay=""}),document.body.classList.remove("idle"),j=[]}const mt="high-contrast",ft="reduced-motion";let B=!1,L=!1;function As(){Rs(),Ts(),Cs(),re()}function Rs(){window.matchMedia("(prefers-reduced-motion: reduce)").matches&&(L=!0,r("reducedMotion",!0)),window.matchMedia("(prefers-contrast: more)").matches&&(B=!0,r("highContrast",!0))}function Ts(){const e=d("highContrast");e!==void 0&&(B=e);const t=d("reducedMotion");t!==void 0&&(L=t)}function Cs(){const e=document.getElementById("high-contrast-toggle");e&&(e.checked=B,e.addEventListener("change",()=>{Nt()}));const t=document.getElementById("reduced-motion-toggle");t&&(t.checked=L,t.addEventListener("change",()=>{Ft()})),window.matchMedia("(prefers-reduced-motion: reduce)").addEventListener("change",n=>{n.matches&&Os(!0)}),window.matchMedia("(prefers-contrast: more)").addEventListener("change",n=>{n.matches&&$s(!0)})}function re(){B?document.body.classList.add(mt):document.body.classList.remove(mt),L?document.body.classList.add(ft):document.body.classList.remove(ft)}function Nt(){B=!B,r("highContrast",B),re();const e=document.getElementById("high-contrast-toggle");return e&&(e.checked=B),B}function Ft(){L=!L,r("reducedMotion",L),re();const e=document.getElementById("reduced-motion-toggle");return e&&(e.checked=L),L}function $s(e){B=e,r("highContrast",e),re();const t=document.getElementById("high-contrast-toggle");t&&(t.checked=e)}function Os(e){L=e,r("reducedMotion",e),re();const t=document.getElementById("reduced-motion-toggle");t&&(t.checked=e)}function Ds(){return B}function he(){return L}const xs=1e3,Ps=60;let D=!1,Se=null,g=null,je=0,Ie=0,_=[],gt=0,ve=1/0,ye=0;function Ns(e=!1){D=e,Fs(),D&&Ut()}function Fs(){if(document.getElementById("fps-display")){g=document.getElementById("fps-display");return}g=document.createElement("div"),g.id="fps-display",g.className=D?"fps-display":"fps-display hidden",g.innerHTML=`
        <div class="fps-current">FPS: --</div>
        <div class="fps-avg">Avg: --</div>
        <div class="fps-range">Min: -- | Max: --</div>
    `;const e=document.createElement("style");e.textContent=`
        .fps-display {
            position: fixed;
            top: 0;
            right: 0;
            background-color: rgba(0, 0, 0, 0.7);
            color: #00ff00;
            padding: 5px 10px;
            font-family: monospace;
            font-size: 12px;
            z-index: 9999;
            border-bottom-left-radius: 5px;
        }
        
        .fps-display.hidden {
            display: none;
        }
        
        .fps-current {
            font-weight: bold;
        }
        
        .fps-avg, .fps-range {
            font-size: 10px;
            opacity: 0.8;
        }
    `,document.head.appendChild(e),document.body.appendChild(g)}function Ut(){g&&g.classList.remove("hidden"),Ie=0,_=[],je=performance.now(),ve=1/0,ye=0,cancelAnimationFrame(Se),Se=requestAnimationFrame(Vt),setInterval(Us,xs)}function Vt(e){Ie++,Se=requestAnimationFrame(Vt)}function Us(){if(!D||!g)return;const e=performance.now(),t=e-je,n=Math.round(Ie*1e3/t);_.push(n),_.length>Ps&&_.shift(),gt=Math.round(_.reduce((s,o)=>s+o,0)/_.length),ve=Math.min(ve,n),ye=Math.max(ye,n),g.querySelector(".fps-current").textContent=`FPS: ${n}`,g.querySelector(".fps-avg").textContent=`Avg: ${gt}`,g.querySelector(".fps-range").textContent=`Min: ${ve} | Max: ${ye}`,Ie=0,je=e,n<30?g.style.color="#ff0000":n<50?g.style.color="#ffff00":g.style.color="#00ff00"}function _t(){return D=!D,D?Ut():(g&&g.classList.add("hidden"),cancelAnimationFrame(Se)),D}function Vs(){_s()}function _s(){const e=document.getElementById("back-from-settings");e&&e.addEventListener("click",Ws);const t=document.querySelectorAll(".tab-btn");t.forEach(w=>{w.addEventListener("click",()=>{const at=w.getAttribute("data-tab");at&&(Ht(at),a("click"),t.forEach(ct=>{ct.setAttribute("aria-selected",ct===w)}))})}),ls(),ms();const n=document.getElementById("sound-toggle-setting");n&&(n.checked=$e(),n.addEventListener("change",()=>{rt(n.checked),n.checked&&a("click")}));const s=document.getElementById("sound-volume");s&&(s.value=an()*100,s.addEventListener("input",()=>{const w=s.value/100;on(w),$e()&&s.value>0&&a("tick")}));const o=document.getElementById("ambient-toggle-setting");o&&(o.checked=sn(),o.addEventListener("change",()=>{nn(o.checked),o.checked?(Le(),a("click")):(ce(),a("click"))}));const i=document.getElementById("ambient-volume");i&&(i.value=rn()*100,i.addEventListener("input",()=>{const w=i.value/100;cn(w),$e()&&i.value>0&&a("tick")}));const c=document.getElementById("sound-style-retro"),m=document.getElementById("sound-style-modern");if(c&&m){const w=dn();c.checked=w==="retro",m.checked=w==="modern",c.addEventListener("change",()=>{c.checked&&(dt("retro"),Fe())}),m.addEventListener("change",()=>{m.checked&&(dt("modern"),Fe())})}const y=document.getElementById("test-sound-btn");y&&y.addEventListener("click",()=>{a("win")});const p=document.getElementById("ai-mode-select");p&&(p.value=J(),pt(J()),p.addEventListener("change",()=>{const w=p.value;In(w),pt(w),a("click")}));const x=document.getElementById("speed-mode-toggle");x&&(x.checked=X(),x.addEventListener("change",()=>{An(x.checked),a("click"),Wt()}));const h=document.getElementById("bonus-rounds-toggle");h&&(h.checked=Ct(),h.addEventListener("change",()=>{xn(h.checked),a("click")}));const ee=document.getElementById("fps-toggle");ee&&ee.addEventListener("change",()=>{_t(),a("click")});const $=document.getElementById("high-contrast-toggle");$&&($.checked=Ds(),$.addEventListener("change",()=>{Nt(),a("click")}));const Ce=document.getElementById("reduced-motion-toggle");Ce&&(Ce.checked=he(),Ce.addEventListener("change",()=>{Ft(),a("click")}));const st=document.getElementById("reset-stats-settings-btn");st&&st.addEventListener("click",()=>{confirm("Are you sure you want to reset your statistics?")&&(We(),a("click"))});const ot=document.getElementById("reset-achievements-btn");ot&&ot.addEventListener("click",()=>{confirm("Are you sure you want to reset your achievements?")&&(Ve(),He(),a("click"))});const it=document.getElementById("delete-all-data-btn");it&&it.addEventListener("click",()=>{confirm("Are you sure you want to delete ALL game data? This cannot be undone.")&&(wt(),ps(),Ve(),We(),He(),Xe("day"),rt(!0),a("click"),alert("All data has been deleted. The game will now reload."),window.location.reload())})}function Wt(){const e=document.getElementById("game-info-banner"),t=document.getElementById("game-info-text"),n=document.querySelector(".game-info-banner-icon");!e||!t||!n||(X()?(e.classList.remove("hidden"),e.classList.add("speed-mode"),t.textContent="Speed Mode Active",n.textContent="⚡"):e.classList.add("hidden"))}function pt(e){const t=document.getElementById("ai-mode-description");let n="",s="";switch(e){case"cheeky":n="Cheeky Mode",s="This AI sometimes copies your last move (40% chance).";break;case"predictive":n="Predictive Mode",s="This AI analyzes your moves and tries to counter your most used choices.";break;case"random":default:n="Random Mode",s="AI picks a move randomly each turn.";break}t&&(t.innerHTML=`
            <h4>${n}</h4>
            <p>${s}</p>
        `)}function Ht(e){document.querySelectorAll(".tab-content").forEach(o=>{o.classList.remove("active"),o.setAttribute("aria-hidden","true")});const n=document.getElementById(`${e}-tab`);n&&(n.classList.add("active"),n.setAttribute("aria-hidden","false")),document.querySelectorAll(".tab-btn").forEach(o=>{o.classList.remove("active"),o.setAttribute("aria-selected","false"),o.getAttribute("data-tab")===e&&(o.classList.add("active"),o.setAttribute("aria-selected","true"))})}function qt(){document.getElementById("landing-page").classList.add("hidden"),document.getElementById("game-screen").classList.add("hidden"),document.getElementById("results-screen").classList.add("hidden"),document.getElementById("stats-screen").classList.add("hidden"),document.getElementById("settings-screen").classList.remove("hidden"),Ht("profile"),a("click")}function Ws(){document.getElementById("settings-screen").classList.add("hidden"),document.getElementById("landing-page").classList.remove("hidden"),a("click")}const nt="1.0";function Hs(){try{const e=js();e.metadata={version:nt,exportDate:new Date().toISOString(),game:"RockPaperBattle"};const t=JSON.stringify(e,null,2),n=`data:text/json;charset=utf-8,${encodeURIComponent(t)}`,s=document.createElement("a");return s.setAttribute("href",n),s.setAttribute("download",`rock-paper-battle-save-${qs(new Date)}.json`),document.body.appendChild(s),s.click(),document.body.removeChild(s),!0}catch(e){return console.error("Failed to export game data:",e),!1}}function qs(e){const t=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0");return`${t}-${n}-${s}`}function js(){const e={};return Object.keys(localStorage).forEach(n=>{if(n.startsWith("RockPaperBattle_")||n==="hasRunBefore")try{e[n]=JSON.parse(localStorage.getItem(n))}catch{e[n]=localStorage.getItem(n)}}),e}function Ys(e){return new Promise((t,n)=>{if(!e){n({success:!1,message:"No file provided"});return}if(e.type!=="application/json"&&!e.name.endsWith(".json")){n({success:!1,message:"Invalid file type. Please select a JSON file"});return}const s=new FileReader;s.onload=o=>{try{const i=JSON.parse(o.target.result),c=Gs(i);if(!c.valid){n({success:!1,message:c.message});return}confirm("This will replace your current game data. Continue?")?(Js(i),t({success:!0,message:"Game data imported successfully!",stats:zs(i)})):n({success:!1,message:"Import cancelled by user"})}catch(i){n({success:!1,message:`Failed to import data: ${i.message}`})}},s.onerror=()=>{n({success:!1,message:"Error reading file"})},s.readAsText(e)})}function Gs(e){if(!e.metadata)return{valid:!1,message:"Invalid save file: Missing metadata"};if(e.metadata.game!=="RockPaperBattle")return{valid:!1,message:"Invalid save file: Not a Rock Paper Battle save file"};const t=e.metadata.version||"0";return Ks(t)?{valid:!0}:{valid:!1,message:`Incompatible save file version: ${t} (current: ${nt})`}}function Ks(e){const t=nt.split(".")[0],n=e.split(".")[0];return t===n}function Js(e){delete e.metadata,wt(),Object.entries(e).forEach(([t,n])=>{try{localStorage.setItem(t,typeof n=="string"?n:JSON.stringify(n))}catch(s){console.error(`Failed to import key ${t}:`,s)}})}function zs(e){const t={totalItems:Object.keys(e).length-1,achievements:0,stats:!1,profile:!1};if(e.RockPaperBattle_achievements){const n=e.RockPaperBattle_achievements;t.achievements=Object.values(n).filter(s=>s.unlocked).length}return e.RockPaperBattle_stats&&(t.stats=!0),e.RockPaperBattle_profile&&(t.profile=!0),t}let E=null;function jt(){Qs()}function Qs(){const e=document.getElementById("loading-bar"),t=document.getElementById("loading-text");Jt(n=>{e&&(e.style.width=`${n}%`),t&&(t.textContent=`Loading game assets: ${n}%`)},()=>{t&&(t.textContent="Ready to play!"),setTimeout(Zs,500)})}function Zs(){const e=document.getElementById("loading-screen");e&&(e.classList.add("fade-out"),setTimeout(()=>{e.style.display="none"},500)),C("landing-page"),en(),ds(),us(),ln(),fn(),Je(),bn(),Es(),Ln(),Dn(),Vs(),As(),Ns(!1),Xs(),no(),so(),to(),eo()}function Xs(){Gt({startEndlessMode:()=>{E="endless",Yn(),a("click"),_e("Endless"),Wt()},backToMenu:()=>{E==="endless"?Zn():E==="bestOf5"&&as(),q(),F()},playAgain:()=>{E==="endless"?Xn():E==="bestOf5"&&cs(),q()},makeMove:h=>{F(),E==="endless"?be(h):E==="bestOf5"&&qe(h),I()}});const e=document.getElementById("best-of-5-btn");e&&e.addEventListener("click",()=>{E="bestOf5",ts(),a("click"),_e("Best of 5");const h=document.getElementById("game-info-banner");h&&h.classList.add("hidden")});const t=document.getElementById("reset-scores");t&&t.addEventListener("click",()=>{E==="endless"?es():E==="bestOf5"&&rs(),q()});const n=document.getElementById("sound-toggle");n&&n.addEventListener("click",tn);const s=document.getElementById("stats-btn");s&&s.addEventListener("click",()=>{ht(),pn()});const o=document.getElementById("back-from-stats");o&&o.addEventListener("click",hn);const i=document.getElementById("reset-stats-btn");i&&i.addEventListener("click",()=>{confirm("Are you sure you want to reset all stats and achievements?")&&(We(),Ve(),He(),ht(),a("click"))});const c=document.getElementById("settings-btn");c&&c.addEventListener("click",qt);const m=document.getElementById("fire-move-btn");m&&m.addEventListener("click",()=>{F();const h=m.getAttribute("data-move");E==="endless"?be(h):E==="bestOf5"&&qe(h),I()});const y=document.getElementById("fps-toggle");y&&y.addEventListener("change",()=>{_t(),a("click")});const p=document.getElementById("export-data-btn");p&&p.addEventListener("click",()=>{Hs(),a("click")});const x=document.getElementById("import-data-file");x&&x.addEventListener("change",h=>{const ee=h.target.files[0];ee&&Ys(ee).then($=>{alert(`Import successful! Imported ${$.stats.totalItems} items including ${$.stats.achievements} achievements.`),window.location.reload()}).catch($=>{alert(`Import failed: ${$.message}`)})}),document.addEventListener("click",I),document.addEventListener("mousemove",I),document.addEventListener("keydown",I)}function eo(){document.addEventListener("keydown",e=>{const t=document.getElementById("game-screen");if(t&&!t.classList.contains("hidden")&&(e.key==="Enter"||e.key===" ")&&document.activeElement.classList.contains("move-btn")){e.preventDefault();const n=document.activeElement.getAttribute("data-move");n&&(F(),E==="endless"?be(n):E==="bestOf5"&&qe(n),I())}if(e.key==="Enter"||e.key===" "){if(document.activeElement.classList.contains("avatar-option")){e.preventDefault();const n=document.activeElement.getAttribute("data-avatar");n&&xt(n)}if(document.activeElement.classList.contains("theme-option")){e.preventDefault();const n=document.activeElement.getAttribute("data-theme");n&&Xe(n)}}})}function to(){window.showWinAnimation=function(){if(he())return;const e=document.querySelector(".confetti-container");if(!e)return;e.innerHTML="";const t=["#ff0000","#00ff00","#0000ff","#ffff00","#ff00ff","#00ffff"];for(let n=0;n<50;n++){const s=document.createElement("div");s.className="confetti-piece",s.style.left=`${Math.random()*100}%`,s.style.top=`${Math.random()*50}%`,s.style.backgroundColor=t[Math.floor(Math.random()*t.length)],s.style.setProperty("--confetti-dx",`${(Math.random()-.5)*300}px`),s.style.setProperty("--confetti-rotate",`${Math.random()*360}deg`),e.appendChild(s)}setTimeout(()=>{e.innerHTML=""},2e3)},window.showLossAnimation=function(e){!e||he()||(e.classList.add("shake-effect"),setTimeout(()=>{e.classList.remove("shake-effect")},500))},window.showDrawAnimation=function(e){!e||he()||(e.classList.add("draw-effect"),setTimeout(()=>{e.classList.remove("draw-effect")},1e3))}}function ht(){const e=document.getElementById("achievements-list");if(!e)return;const t=mn();e.innerHTML="",t.forEach(n=>{const s=document.createElement("div");s.className=`achievement-item ${n.unlocked?"unlocked":"locked"}`,s.setAttribute("role","listitem");const o=n.unlocked?"Unlocked":"Locked";s.setAttribute("aria-label",`${n.name} - ${o} - ${n.description}`),s.innerHTML=`
            <div class="achievement-icon">${n.icon}</div>
            <div class="achievement-content">
                <h4>${n.name}</h4>
                <p>${n.description}</p>
            </div>
        `,e.appendChild(s)})}function no(){d()}function so(){d("hasRunBefore")||(r("hasRunBefore",!0),setTimeout(()=>{qt()},1e3))}function oo(){ce()}window.addEventListener("DOMContentLoaded",jt);window.addEventListener("beforeunload",oo);(document.readyState==="interactive"||document.readyState==="complete")&&jt();
